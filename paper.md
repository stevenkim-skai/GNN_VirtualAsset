# paper

그래프 데이터베이스와 AI를 활용한
가상자산 조세포탈 대응 방안Analysis of Tax Evasion through Virtual Asset
based on Graph Database and AI
2025년 1월
서울대학교 융합과학기술대학원
수리정보과학과 정보보호 및 디지털포렌식학 전공장 희 원
그래프 데이터베이스와 AI를 활용한 가상자산 조세포탈 대응 방안지도교수 국 웅
이 논문을 이학석사 학위논문으로 제출함2024년 12월
서울대학교 융합과학기술대학원
수리정보과학과 정보보호 및 디지털포렌식학
장 희 원
장희원의 석사 학위논문을 인준함
2024년 12월
위 원 장 박 상 철 (인)
부위원장 국 웅 (인)
위 원 이 병 영 (인)

- i -
국문초록
가상자산은 익명성과 탈중앙성으로 인해 범죄 수단으로 악용되는사례가 증가하고 있으며, 이에 대응하기 위해 우리나라는 2021년부터 가상자산 거래자 신원 확인 제도를 도입하여 시행하고 있다.
가상자산 거래자 신원 확인 제도 시행에 따라 중앙화 거래소(CE
X)와 직접 연결되어 있는 가상자산 거래는 거래자의 신원을 확인할수 있게 되었지만, CEX와 직접 연결되어 있지 않은 가상자산 거래는 여전히 익명성 문제가 남아있다.
CEX와 직접 연결되어 있지 않은 가상자산 거래의 거래자를 확인하기 위해서는 블록체인 트랜잭션 데이터까지 활용하여야 하는데,
아직 블록체인 트랜잭션 데이터를 활용한 가상자산 조세포탈 대응방안에 대한 연구는 부족한 실정이다.
본 연구는 블록체인 트랜잭션 데이터를 그래프 데이터베이스로 모델링하고 AI로 조세포탈 거래를 직접 예측하는 대신 지갑 주소별이상 거래 패턴을 탐지하고, 이상 거래 패턴의 발생 원인을 머신러닝으로 수치화하여 분석하였다. 이를 통해 이상 거래 패턴 기반 조세포탈 위험도 분석 방법과 CEX 관련 지갑 주소로 연결되는 가상자산의 흐름을 그래프로 시각화하여 분석하기 위한 방법을 기반으로 가상자산 조세포탈 대응 방안을 제시하고자 한다.
주요어 : 그래프 데이터베이스, AI, 그래프 신경망, 가상자산, 조세포탈
학 번 : 2023-29845
- ii -
목 차
제 1 장 서론 ································································· 1
제 1 절 연구 배경 ································································· 1
제 2 절 문제 제기 ································································· 3
제 3 절 연구 방법 ································································· 4
제 4 절 선행 연구 ································································· 5
제 2 장 그래프 데이터베이스 모델링 ··················· 7
제 1 절 블록체인 트랜잭션 데이터 ·································· 7
1. PicaArtMoney 트랜잭션 ····················································· 7
2. 데이터 수집 및 변환 ··························································· 8
제 2 절 그래프 데이터베이스 모델링 ······························ 11
3. 그래프 설계 ··········································································· 11
4. 특수 거래 패턴 레이블 부여 ············································· 15
제 3 장 그래프 데이터베이스 분석 ······················· 22
제 1 절 AI 기반 이상 거래 패턴 분석 ··························· 22
5. 그래프 신경망 모델(GAT) ················································· 22
6. GAT 모델 학습 ···································································· 23
7. GAT 기반 이상 거래 패턴 탐지 ······································ 25
8. 머신러닝 모델(XGBoost) ···················································· 25
9. XGBoost 모델 학습 ····························································· 27
- iii -
1. XGBoost 기반 재구성 오차 발생 원인 분석 ················· 27
2. XGBoost 기반 속성별 상관관계 분석 ····························· 31
3. 이상 거래 패턴 지갑 주소 사례 연구 ····························· 36
4. 이상 거래 패턴 기반 조세포탈 위험도 분석 ················· 46
제 2 절 그래프 기반 가상자산 이동 경로 분석 ··········· 49
5. 중앙화 거래소 입금 전용 지갑 주소 사례 연구 ··········· 49
6. 중앙화 거래소 관리 목적 지갑 주소 사례 연구 ··········· 50
7. 중앙화 거래소 간 가상자산 이동 경로 분석 ················· 51
제 4 장 가상자산 조세포탈 대응 방안 ················· 54
제 1 절 가상자산 실명 확인 과세자료 ···························· 54
8. 소득세법 및 법인세법 상 가상자산 거래 명세서 ········· 54
9. 국조법 상 해외금융계좌 신고서 ······································· 55
10. 금융정보분석원 법집행기관 제공 자료 ··························· 58
11. 의의 및 한계점 ····································································· 60
제 2 절 가상자산 조세포탈 대응 방안 ···························· 61
12. 자체 개발 프로그램 ··························································· 61
13. 프로그램 기반 가상자산 조세포탈 대응 방안 ··············· 66
제 5 장 결론 ································································ 72
참고문헌 ········································································ 73
- iv -
표 목 차
[표 1] ERC-20 트랜잭션 데이터 구조 ········································· 7
[표 2] 이더스캔 API 트랜잭션 데이터 레이아웃 ······················ 9
[표 3] 지갑 주소 노드에 추가된 속성 ········································· 13
[표 4] 특수 거래 패턴 레이블 ······················································· 15
[표 5] GAT 모델 파라미터 ···························································· 23
[표 6] Node2Vec 파라미터 ····························································· 24
[표 7] XGBoost 분류 모델 파라미터 ··········································· 26
[표 8] XGBoost 분류 모델 혼동 행렬 ········································· 28
[표 9] GAT 모델 이상 거래 패턴 탐지 요인 분석 결과 ········ 28
[표 10] 이상 거래 패턴 주요 요인 속성 간 상관관계 분석 ··· 31
[표 11] 이상 거래 패턴 지갑 주소 유형별 특징 ······················· 36
[표 12] 이상 거래 패턴 지갑 주소의 속성 정보 ······················· 37
[표 13] 중앙화 거래소 입금 전용 지갑 주소 사례 연구 ········· 49
[표 14] 중앙화 거래소 관리 목적 지갑 주소 사례 연구 ········· 51
[표 15] T3 프로그램 엑셀 파일 분석 상세 내역 ······················ 64
- v -
그 림 목 차
[그림 1] 이더리움 트랜잭션 데이터 수집 코드 ························· 8
[그림 2] 트랜잭션 데이터 변환 전과 후 비교 예시 ················· 10
[그림 3] 그래프 데이터베이스 모델링 기본 설계 ····················· 11
[그림 4] 그래프 데이터베이스 모델링 단순화 ··························· 12
[그림 5] 그래프 데이터베이스 모델링 최종 결과 ····················· 14
[그림 6] A_silkroad 레이블 Cypher 쿼리 ··································· 16
[그림 7] B_pocket 레이블 Cypher 쿼리 ······································ 16
[그림 8] C_bottleneck 레이블 Cypher 쿼리 ······························· 17
[그림 9] D_receiver 레이블 Cypher 쿼리 ··································· 17
[그림 10] E_passthrough 레이블 Cypher 쿼리 ························· 18
[그림 11] F_supernode 레이블 Cypher 쿼리 ····························· 18
[그림 12] G_genesis 레이블 Cypher 쿼리 ·································· 19
[그림 13] H_horizon 레이블 Cypher 쿼리 ·································· 20
[그림 14] I_identifier 레이블 Cypher 쿼리 ································· 20
[그림 15] X_exchange 레이블 Cypher 쿼리 ······························ 21
[그림 16] 이상 거래 패턴 유형1 지갑 주소 정보 ····················· 40
[그림 17] 이상 거래 패턴 유형1 컨트랙트 소스코드 일부 ····· 40
[그림 18] 이상 거래 패턴 유형1 트랜잭션 내역 ······················· 41
[그림 19] 이상 거래 패턴 유형2 지갑 주소 정보 ····················· 42
[그림 20] 이상 거래 패턴 유형2 트랜잭션 내역 ······················· 43
[그림 21] 이상 거래 패턴 유형3 지갑 주소 정보 ····················· 44
[그림 22] 이상 거래 패턴 유형3 컨트랙트 소스코드 ··············· 45
[그림 23] 이상 거래 패턴 유형3 트랜잭션 내역 ······················· 46
- vi -
[그림 24] 중앙화 거래소 간 이동 경로 그래프 쿼리 예시 ····· 52
[그림 25] 중앙화 거래소 간 이동 경로 시각화 예시 ··············· 52
[그림 26] 중앙화 거래소 입금 전용 지갑 주소 트랜잭션 ······· 53
[그림 27] 소득세법 상 가상자산 거래명세서 ····························· 55
[그림 28] 국조법 상 해외금융계좌 신고서 ································· 56
[그림 29] T3 XGBoost 속성별 모델 분석 결과 화면 ·············· 65
[그림 30] 가상자산 발행 관련 조세포탈 사례 ··························· 66
[그림 31] AI 기반 이상 거래 패턴 분석 개념도 ······················· 67
[그림 32] 이더리움 및 트론 테더 발행 비중 ····························· 68
[그림 33] 이더리움 ERC-20 테더 발행량 ··································· 69
- 1 -
제 1 장 서 론
제 1 절 연구 배경
블록체인 기술은 거래 참여자 모두가 거래 내용을 신뢰할 수 있는 획기적인 거래 시스템을 제시해 주었지만, 익명성과 탈중앙성으로 인해 범죄의 도구로 변질되어 사용되는 문제가 발생하였으며, 가상자산이 범죄에악용되는 사례는 해마다 증가하고 있는 추세이다.1)
우리나라는 가상자산 범죄 문제를 해결하기 위해 자금세탁방지국제기구(
FATF)의 권고사항을 받아들여 2021년 특정 금융거래정보의 보고 및 이용 등에 관한 법률(이하, 특정금융정보법)을 개정하여 트래블룰을 도입하였으며, 같은 해 세법을 개정하여 중앙화된 거래소가 가상자산 거래내역을 분기별로 국세청에 의무적으로 제출하도록 하는 제도를 마련하였다.2)
가상자산 거래자 신원 확인 제도가 시행됨에 따라 중앙화된 거래소(CEX)를 통하는 가상자산 거래의 거래자 신원 정보를 파악할 수 있게 되었다. 하지만, CEX와 직접 연결된 거래가 아닌 경우에는 여전히 거래자의 신원 정보를 파악할 수 없기 때문에 이를 파악하기 위해서는 가상자산거래자 신원 확인 제도를 통해 확인되는 정보와 함께 블록체인 트랜잭션데이터도 함께 활용하여야 한다.
블록체인 트랜잭션 데이터를 효과적으로 활용하기 위해 그래프 데이터베이스를 사용할 수 있는데, 전 세계적으로 가장 많이 사용되는 그래프 데1) 2023년 기준 불법 주소로 입금된 가상자산 총액 약 30조원. : 『2024 가상자산범죄 보고서』, (체이널리시스, 2024), 3면.
1. 법인세법 120조의4, 소득세법 제164조의4
- 2 -
이터베이스인 Neo4j의 Community 버전은 웹브라우저를 통해 그래프 시각화와 쿼리 실행 기능을 제공하고 있으며 무료로 공개되어 있다.
Neo4j 그래프 데이터베이스로 모델링된 블록체인 트랜잭션 데이터는 그래프 신경망으로 학습이 가능하다. 그래프 신경망은 개체(Entiry)의 속성뿐만 아니라 그래프의 구조적 특성까지도 학습 가능한 딥러닝 기반 AI
모델이다. 그래프 신경망 중에서도 GAT(Graph Attention Network)는 어텐션 메커니즘(Attention Mechanism)을 사용하여 전통적인 모델에 비해보다 정교한 분석이 가능하다는 장점이 있다.
GAT 모델에 지도 학습(Supervised Learning) 방법을 적용하려면 레이블(Label)이 있는 학습 데이터가 필요하지만 오토인코딩(Autoencoding)
기법을 결합한 비지도 학습(Unsupervised Learning) GAT 모델을 사용하면 레이블이 없이도 그래프 임베딩 벡터(Graph Embedding Vector)의 차원(Dimension)을 축소하고 다시 복원하는 과정에서 이상 패턴(Anomaly
Pattern)을 탐지(Detect)해서 지갑 주소별 이상 거래 패턴의 발생 정도를수치(재구성 오차, Reconstruction Error)로 측정할 수 있다.
오토인코딩 기법을 사용한 GAT 모델로 지갑 주소별 재구성 오차를 측정할 수 있고, 재구성 오차를 머신러닝(XGBoost3)) 모델로 학습하면, 이상거래 패턴이 어떤 원인에 의해 발생했는지 확인할 수 있기 때문에 이를심층적으로 분석하면 지갑 주소별 조세포탈 위험도를 판단할 수 있다.
이처럼 가상자산 거래자 신원 확인 제도의 도입으로 인해 CEX와 직접연결된 가상자산 거래의 거래자 신원을 확인할 수 있게 되었고, 인공지능기술의 발전으로 인해 그래프 데이터베이스와 AI를 활용한 블록체인 트랜잭션 데이터 분석이 가능해졌지만, 이를 국세 행정 실무에 효과적으로활용하기 위한 방안에 대한 연구는 아직 부족한 실정이다.
1. 트리 기반 최적화 등을 지원하는 그래디언트 부스팅 확장형 머신러닝 모델
- 3 -
제 2 절 문제 제기
현행 가상자산 조세포탈 대응 체계와 관련하여 본 연구에서 해결하고자하는 문제는 다음과 같다.
첫째, CEX와 직접 연결되어 있지 않은 가상자산 거래에 대한 조세포탈대응의 문제이다. 현행 가상자산 거래자 신원 확인 제도는 가상자산 사업자를 중심으로 중앙화 거래소와 직접 연결된 거래만을 대상으로 삼고 있기 때문에 중앙화 거래소와 직접 연결되어 있지 않은 가상자산 거래는 조세포탈 대응의 사각 지대에 머물러 있게 된다.
조세포탈 목적의 변칙적인 가상자산 거래는 복잡한 거래 구조를 통해 이루어지는 경향이 있기 때문에 이에 대한 대응이 상대적으로 더 중요하다.
따라서, 효과적인 조세포탈 대응을 위해서는 중앙화 거래소와 직접 연결되지 않은 거래 정보를 반드시 활용할 필요가 있다.
둘째, 그래프 데이터베이스를 활용한 가상자산 조세포탈 대응 방안이 마련되어 있지 않다는 점이다. 블록체인 트랜잭션 데이터의 효과적인 분석을 위해서는 각 지갑 주소간의 연결 관계를 표현할 수 있는 그래프 데이터베이스의 사용이 반드시 필요하지만 이를 구현하고 분석하기 위한 방법에 대한 연구가 부족하여 이를 활용한 가상자산 조세포탈 대응 방안이 마련되지 않고 있다.
셋째, 블록체인 트랜잭션 데이터 분석용 지도 학습 AI 모델에 필요한 학습 데이터가 충분하지 않다는 점과 블록체인 트랜잭션 데이터에서 이상거래 패턴을 분석하여 조세포탈 위험도를 측정하기 위한 비지도 학습 AI
모델을 효과적으로 구현하기 위한 연구가 부족하다는 점이다.
- 4 -
제 3 절 연구 방법
앞서 제기된 문제들을 해결하기 위해 본 연구에서는 다음과 같은 두 가지 접근 방식을 사용하였다.
첫째, 분석 능력 한도 내에서 데이터의 범위를 한정할 수 있는 이더리움블록체인 ERC-20 토큰(PicaArtMoney, 이하 PICA)을 선정하여 해당 토큰의 트랜잭션 데이터 전체를 수집하고 Neo4j 그래프 데이터베이스로 모델링하여 구축하였다.
연구에 사용된 PICA는 이더리움 블록체인에서 2020년 10월 13일부터 20
24년 8월 7일까지 생성된 26,760개의 트랜잭션 데이터이며, 데이터 수집은이더스캔 API를 활용하였다.
그래프 데이터베이스 모델링에서는 중앙화 거래소와 직접 연결되지 않은거래 흐름을 분석하기 위해 중앙화 거래소 관련 지갑 주소의 거래 패턴을가진 지갑 주소에는 이를 구별할 수 있는 임의의 레이블을 부여하였다.
둘째, AI 모델로 측정한 지갑 주소별 이상 거래 패턴 수치를 기반으로조세포탈 위험도 평가 방법을 연구하였다. 이를 위해, 먼저 오토인코딩 기법을 사용한 그래프 신경망(GAT) 모델로 지갑 주소별 이상 거래 패턴수치를 측정한 다음 이를 머신러닝 모델(XGBoost)로 학습하여 이상 거래패턴의 발생 원인과 성격을 분석하고, 또한, 재구성 오차가 큰 지갑 주소는 실제 사례를 심층적으로 연구하였다.
가상자산 조세포탈 대응 방안은 분석 결과를 종합하여 파이썬 프로그램으로 구현하고 이를 기반으로 AI 기반 가상자산 조세포탈 위험 거래 모니터링 방안과 그래프 데이터베이스 기반 가상자산 이동 경로 분석 결과활용 방안으로 구분하여 제시하였다.
- 5 -
제 4 절 선행 연구
1. 그래프 신경망(GAT)
전통적인 그래프 신경망 모델인 GNN, GCN가 노드간의 연결 강도를 모두 동일하게 반영하는데 반해, GAT는 어텐션 메커니즘을 사용하여 이웃노드의 중요도를 학습하여 노드 간의 연결 강도를 차별적으로 적용하여그래프 구조를 보다 정교하게 학습해서 표현할 수 있는 모델이다.4)
Veličković et al.(2018)에 따르면 GAT는 대표적인 그래프 신경망 평가데이터셋에서 높은 성능을 보였다. Cora 데이터셋에서 83%, Citeseer 데이터셋에서는 72.5%. Pubmed에서는 79%의 정확도로 기존 모델인 GCN
보다 높은 성능을 나타냈다.
2. GAT 기반 이상 패턴 탐지
You et al. (2020)은 그래프 구조와 노드의 속성을 동시에 학습하여 측정한 재구성 오차를 기반으로 이상 패턴을 탐지하는 GAT 기반의 오토인코더 모델을 제안하고, Cora와 Pubmed 데이터 셋에서 ROC-AUC를 평가한결과 Cora 데이터 셋에서 0.91, Pubmed 데이터 셋에서 0.96을 기록하여기존 이상 탐지 방법(LOF, IF, Dominant)들보다 우수한 성능을 보였다.5)
3. Petar Veliˇckovi´c, Guillem Cucurull, Arantxa Casanova, Adriana Romero,
Pietro Li`o, Yoshua Bengio, “GRAPH ATTENTION NETWORKS”, ICLR
(2018.2)
5 Ziquan You, Xiaoying Gan, Luoyi Fu, Zhen Wang, "GATAE: Graph Atten
tion-based Anomaly Detection on Attributed Networks", ICCC (2020)
- 6 -
GAT 모델이 복잡한 구조를 가진 학술 네트워크와 생물·의학 논문 네트워크인 Cora와 Pubmed 데이터셋에서 우수한 이상 탐지 성능을 보였다는점에서, GAT 모델은 블록체인 트랜잭션 데이터 분석에도 효과적으로 활용될 수 있을 것으로 판단된다.
1. GAT 기반 자금세탁 거래 패턴 탐지
Yu et al. (2023)은 Elliptic 데이터 셋에서 GAT 모델을 활용해 Peeling
Chain, 순환 거래, 거래 폭발, 중심 허브 패턴 등 주요 자금세탁 거래 패턴을 높은 정확도(F1-score 0.899)로 탐지하였다.6)
가상자산 조세포탈 거래는 소득과 자금 출처를 은닉하는 과정에서 자금세탁 거래와 같은 거래 패턴이 나타날 수 있기 때문에 GAT 모델을 활용한 조세포탈 위험 거래 패턴 탐지가 가능할 것으로 판단된다.
2. 머신러닝 알고리즘(XGBoost)
Chen et al. (2016)은 대규모 데이터 셋에서 효율적 학습이 가능한 머신러닝 학습 알고리즘인 XGBoost을 제안하였으며, 1.7억 건 규모의 Criteo
클릭률 예측 데이터 셋에서 안정적인 성능을 나타냈다.7)
XGBoost가 다양한 대규모 데이터 셋에서 높은 성능을 보였다는 점에서대규모 블록체인 트랜잭션 데이터 분석도 가능할 것으로 판단된다.
3. Yu et al., “Who Are the Money Launderers? Money Laundering Detection
on Blockchain via Mutual Learning-Based Graph Neural Network”, IJCNN
(2023)
4. Tianqi Chen, “XGBoost: A Scalable Tree Boosting System”, KDD (2016)
- 7 -
구 분 설 명
blockNumber 해당 트랜잭션이 포함된 블록의 번호
timestamp 블록이 만들어진 시간(유닉스 타임 형식)
from 송신자 주소
to 수신자 주소
value 전송된 토큰의 수량
gasPrice 트랜잭션 실행에 사용된 가스 단위 당 수량
gasUsed 트랜잭션 실행에 사용된 가스의 양
tokenAddress 토큰의 고유 식별 값
transactionHash 트랜잭션의 해시 값
제 2 장 그래프 데이터베이스 모델링제 1 절 블록체인 트랜잭션 데이터
1. PicaArtMoney 트랜잭션
본 연구에서 사용한 데이터셋은 이더리움 블록체인에서 2020년 10월 13
일부터 2024년 8월 7일까지 생성된 ERC-20 기반 토큰인 PicaArtMoney(
이하, PICA)의 전체 트랜잭션 데이터(총 26,760개)이다.
ERC-20은 이더리움 블록체인에서 토큰을 발행할 때 가장 많이 사용되는 표준 인터페이스로, 토큰의 발행, 전송, 승인 등과 관련된 규칙과 동작방식을 정의하고 있다. ERC-20 토큰의 트랜잭션 데이터에 기록되는 주요정보는 다음과 같다.
[표 1] ERC-20 트랜잭션 데이터 구조
- 8 -
import request
import pandas as pd
token_address = ‘0xA7E0719a65128b2f6cDbc86096753Ff7d5962106’
init_block = '0'
api_key = '511PEXIYJQD2HVS4D65KJUZTXXXXXXXXXX'
cnt_data = 0
url, init_start_block, temp_end_block =
get_token_block_range(token_address, init_block, 9999999999999, 1, 10000,
api_key, 0) next_end_block = int(temp_end_block) init = 0
col_block = ['blockNumber', 'timeStamp', 'hash', 'nonce',
'blockHash', 'from', 'contractAddress', 'to', 'value', 'tokenName',
'tokenSymbol', 'tokenDecimal', 'transactionIndex', 'gas', 'gasPrice',
'gasUsed', 'cumulativeGasUsed', 'input', 'confirmations'] name_chk = 0
ERC-20 기반 토큰의 트랜잭션 데이터는 송신자와 수신자의 주소가 일대일로 대응되기 때문에 트랜잭션 데이터의 from 값과 to 값을 사용해서방향성 그래프(Directed Graph)로 모델링할 수 있다.
1. 데이터 수집 및 변환
1.1 데이터 수집
PICA 트랜잭션 데이터는 이더스캔 API를 통해 다운로드 할 수 있지만,
API 요청이 최대 1만건으로 제한되어 있기 때문에 블록 구간을 지정하여분할하여 요청하여야 한다. 본 연구에서는 자체 제작한 파이썬 프로그램(
T1)을 사용하여 PICA 트랜잭션 데이터를 수집하였다. 본 연구에서 사용한 파이썬 프로그램의 코드 예시는 다음과 같다.
- 9 -
file_list_erc20 = []
while next_end_block is not None: if init == 0: this_start_block = init_start_block
else: this_start_block = next_start_block
this_end_block = int(next_end_block) url, dontuse_start_block, dontuse_end_block =
get_token_block_range(token_address, this_start_block, this_end_block, 1,
10000, api_key, 2)
response = requests.get(url) data = response.json() transactions = data["result"] df = pd.DataFrame(columns=col_block)
구 분 설 명
blockNumber 해당 트랜잭션이 속해 있는 블록의 번호
timeStamp 해당 트랜잭션이 채굴된 시간(타임스탬프)
hash 해당 트랜잭션 해시 값
nonce 해당 트랜잭션의 일련 번호
blockHash 해당 트랜잭션이 속해 있는 블록의 해시 값
[그림 1] 이더리움 트랜잭션 데이터 수집 코드
1.2 데이터 변환
이더스캔([Etherscan.io](http://etherscan.io/))에서 수집한 트랜잭션 데이터의 value(거래 수량)
값은 소수점 자릿수가 반영되어 있지 않기 때문에 tokenDecimal 값을 반영하여 소수점 자릿수를 조정해야 한다. 이더스캔 API로 수집한 트랜잭션데이터의 레이아웃은 다음과 같다.
- 10 -
from 송신자의 지갑 주소
contractAddress 컨트랙트 주소
to 수신자의 지갑 주소
value 전송된 토큰의 양
tokenName 토큰 이름
tokenSymbol 토큰 심볼
tokenDecimal 토큰의 소수점 이하 자릿수
transactionIndex 트랜잭션의 인덱스
gas 송신자가 허용한 최대 가스의 양
gasPrice 가스 단위당 지불할 의사가 있는 가격
gasUsed 해당 트랜잭션이 실제로 사용한 가스의 양
cumulativeGasUsed 블록 내에서 사용된 누적된 가스의 양
input 해당 트랜잭션과 함께 전송된 입력 데이터
confirmations 해당 트랜잭션이 받은 확인 횟수
구분 value tokenDecimal
변환 전 820000000000
10
변환 후 82
[표 2] 이더스캔 API 트랜잭션 데이터 레이아웃
tokenDecimal 값을 이용한 value 값의 자릿수 조정 예시는 다음과 같다.
[그림 2] 트랜잭션 데이터 변환 전과 후 비교 예시
- 11 -
제 2 절 그래프 데이터베이스 모델링
1. 그래프 설계
1.1 기본 설계
그래프 데이터베이스 모델링 시 기본 설계 단계에서 사용하는 그래프 개체(Entity)는 addr 노드와 FROM_TO 엣지이다. addr 노드는 트랜잭션 데이터 각 행의 from 값과 to 값을 address 속성 값으로 가지며, 지갑 주소를 의미한다. FROM_TO 엣지는 txHash, value, gas, timestamp를 속성값으로 가지며, from 지갑 주소에서 to 지갑 주소 방향으로 관계가 설정된다. 이 때, 동일한 from 지갑 주소와 to 지갑 주소 사이에 다수의 트랜잭션이 발생한 경우 트랜잭션 횟수만큼 다수의 FROM_TO 엣지가 생성된다.
[그림 3] 그래프 데이터베이스 모델링 기본 설계
- 12 -
1.2 모델링 단순화
직관적인 그래프 시각화와 분석의 효율성을 위해 그래프 데이터베이스의addr 노드 사이에 다수의 FROM_TO 엣지가 연결되어 있는 경우 이를요약하여 하나의 NET_TO 엣지로 표현하였다. 또한, FROM_TO 엣지 방향에 따라 value 값을 가감한 순 거래 수량을 NET_TO 엣지의 netValue
속성 값으로, 순 거래 횟수를 netCount 속성 값으로, timestamp 중 가장빠른 시간을 earlitestTimestamp 속성 값으로 설정하였다.
[그림 4] 그래프 데이터베이스 모델링 단순화
1.3. 노드 속성 추가
지갑 주소의 거래 패턴 분석에 필요한 총 37가지의 정보(이하, 37가지추가 속성)를 미리 계산하여 addr 노드에 추가 속성을 부여하였다. addr
노드에 추가된 37가지 추가 속성은 다음 표와 같다.
- 13 -
속 성 설 명
uniqueEdgesIn 송신 트랜잭션의 유일한 상대방이 해당 노드인 노드
(들)의 수(이하, 유일 송신 엣지 개수)
uniqueEdgesOut 수신 트랜잭션의 유일한 상대방이 해당 노드인 노드
(들)의 수(이하 유일 수신 엣지 개수)
uniqueValIn 송신 트랜잭션의 유일한 상대방이 해당 노드인 노드
(들)의 트랜잭션 수량 합계(이하, 유일 송신 총 수량)
uniqueValOut 수신 트랜잭션의 유일한 상대방이 해당 노드인 노드
(들)의 트랜잭션 수량 합계(이하, 유일 수신 총 수량)
dijkstra 가중치를 고려한 최초 노드로부터의 최단 경로 거리
distance 최초 노드로부터의 최단 경로 거리
cycles 해당 노드가 포함된 순환 거래의 수
returns 송·수신 트랜잭션이 모두 있는 상대방의 수
daysCntOutlier 트랜잭션 횟수가 비정상적으로 높은 날의 수
daysValOutlier 트랜잭션 수량이 비정상적으로 높은 날의 수
daysGasOutlier 가스 허용량이 비정상적으로 높은 날의 수
volatility 트랜잭션 수량의 변동성(FROM_TO 기준)
centralityCloseness 다른 모든 노드와 가까운 정도(백분위)
centralityBetweenness 다른 노드 최단 경로의 중간 위치 빈도(백분위)
centralityPagerank 영향력 있는 노드와 연결되어 있는 정도(백분위)
centralityDegree 직접 연결된 엣지(FROM_TO)의 수(백분위)
edgesIn 수신 트랜잭션으로 연결된 상대방의 수
edgesOut 송신 트랜잭션으로 연결된 상대방의 수
totCntIn 총 수신 트랜잭션 횟수(FROM_TO 기준)
totCntOut 총 송신 트랜잭션 횟수(FROM_TO 기준)
totValIn 총 수신 트랜잭션 수량(FROM_TO 기준)
totValOut 총 송신 트랜잭션 수량(FROM_TO 기준)
avgValIn 수신 트랜잭션 수량 평균 값(FROM_TO 기준)
avgValOut 송신 트랜잭션 수량 평균 값(FROM_TO 기준)
totGasIn 수신 트랜잭션에 허용된 총 가스량(FROM_TO)
totGasOut 송신 트랜잭션에 허용된 총 가스량(FROM_TO)
avgGasIn 수신 트랜잭션 평균 가스 허용량(FROM_TO)
- 14 -
avgGasOut 송신 트랜잭션 평균 가스 허용량(FROM_TO)
totCntDays 트랜잭션이 발생한 총 일수
period 트랜잭션 주기
lifetime 첫 트랜잭션과 마지막(전체) 트랜잭션 사이의 일수
avgCntDaily 일평균 트랜잭션 횟수
avgValDaily 일평균 트랜잭션 수량
gasEfficiencyIn 수신 트랜잭션 가스 효율 (총 거래수량/총 가스량)
gasEfficiencyOut 송신 트랜잭션 가스 효율 (총 거래수량/총 가스량)
firstTransaction 첫 번째 트랜잭션 발생 시간
lastTransaction 마지막 트랜잭션 발생 시간
[표 3] 지갑 주소 노드에 추가된 속성
[그림 5] 그래프 데이터베이스 모델링 최종 결과
- 15 -
이름 설명 의미
A_silkroad 상위 1% 송수신
노드
거래 수량이 상위 1%인 송·수신 트랜잭
션이 발생한 노드
B_pocket 수신거래만 있는
노드
수신 트랜잭션만 있고 송신 트랜잭션은
없는 노드
C_bottleneck 병목 노드 수신 거래가 많이 발생하지만 송신
거래는 적은 병목 구조의 노드
D_receiver 병목 노드로부터
수신하는 노드
C_bottleneck 으로부터 수신 트랜잭션이
발생하는 노드
E_passthrough 도관 노드 도관 역할을 하는 노드
F_supernode 소규모 거래
대량 발생 노드
유일한 수신 트랜잭션 상대방이 해당 노
드인 소규모 노드가 매우 많은 노드
G_genesis 최초 트랜잭션
송신 노드 최초 트랜잭션 송신 노드
H_horizon 마지막 트랜잭션
수신 노드 마지막 트랜잭션 수신 노드
I_identifier 거래소 입금지갑
유형 노드
거래소 관리 목적 지갑 주소 노드로 발
신 거래만 있는 노드
X_exchange 거래소 관리지갑
유형 노드
n개 이상 거래소 입금 전용 지갑 주소
노드로부터 수신 거래가 있는 노드
1. 특수 거래 패턴 레이블 부여
본 연구에서는 지갑 주소별로 거래 패턴을 시각화하고 압축적으로 표현하기 위해 지갑 주소의 거래 유형을 10가지 레이블로 분류하고 거래 유형에 따라 지갑 주소 노드에 레이블을 부여하였다.
[표 4] 특수 거래 패턴 레이블
- 16 -
MATCH ()-[r]->() WITH r.netValue AS value
ORDER BY value DESC
WITH collect(value) AS values
WITH values[toInteger(size(values) * 0.01)] AS top1PercentValue
MATCH (a)-[r]->(b) WHERE r.netValue >= top1PercentValue
SET a:A_silkroad, b:A_silkroad
MATCH (n:addr) WHERE n.edgesIn > 0 and n.edgesOut = 0
SET n:B_pocket
2.1 A_Silkroad
A_Silkroad 레이블은 거래 수량이 상위 1% 이상인 송신 또는 수신 트랜잭션이 발생한 지갑 주소 노드에 부여된다.
해당 레이블을 가진 지갑 주소는 상대적으로 매우 큰 규모의 트랜잭션이발생한 지갑 주소로서 해당 토큰을 실질적으로 발행하고 유통하는 주체와관련된 지갑 주소일 가능성이 높다.
[그림 6] A_silkroad 레이블 Cypher 쿼리
2.2 B_pocket
B_pocket 레이블은 수신 트랜잭션만 있고 송신 트랜잭션은 없는 지갑주소 노드에 부여된다.
해당 레이블은 그래프 경로의 말단에서 토큰을 수신한 지갑 주소로서,
토큰 유통 경로의 종착지로서의 의미를 지닌다.
[그림 7] B_pocket 레이블 Cypher 쿼리
- 17 -
MATCH (n:addr) WHERE n.edgesIn > 10 and ((0 < n.edgesOut < n.edgesIn/4) or (0 <
n.edgesOut < 5)) SET n:C_bottleneck
MATCH (a:C_bottleneck)-[r*1..1]->(b:addr) SET b:D_receiver
2.3 C_bottleneck
C_bottleneck 레이블은 수신 트랜잭션의 상대방 노드는 많고, 송신 트랜잭션의 상대방 노드는 적은 노드에 부여된다.
해당 레이블은 여러 지갑 주소로부터 토큰을 수신하고, 소수의 지갑 주소로 수신한 토큰을 전달하는 역할을 하는 지갑 주소이다. 해당 레이블이부여된 지갑 주소 노드는 그래프 경로에서 토큰을 발행하고 유통하는데중요한 역할을 하고 있는 노드와 연결되어 있을 가능성이 높다.
[그림 8] C_bottleneck 레이블 Cypher 쿼리
2.4 D_receiver
D_receiver 레이블을 가진 노드는 다수의 지갑 주소로부터 C_bottleneck
레이블을 가진 노드를 통해 간접적으로 토큰을 전달받는 노드이다.
[그림 9] D_receiver 레이블 Cypher 쿼리
2.5 E_passthrough
E_passthrough 레이블을 가진 노드는 수신 트랜잭션이 하나 이상 있고
- 18 -
MATCH (n:addr) WHERE n.edgesIn > 0 and n.edgesOut > 10
SET n:E_passthrough
MATCH (n:addr)
송신 트랜잭션이 다수인 지갑 주소 노드이다.
해당 레이블을 가진 노드는 다수의 지갑 주소로 토큰을 배분하는 노드로가상자산 유통망의 분기점에 해당한다. 그래프에서 해당 노드를 기준으로영역을 구분해서 분석하면 가상자산의 흐름을 효율적으로 파악할 수 있다.
[그림 10] E_passthrough 레이블 Cypher 쿼리
2.6 F_supernode
F_supernode 레이블을 가진 노드는 특정 거래 패턴을 가진 소규모 노드8)(이하, leaf노드) 방향으로 n개 이상의 송신 트랜잭션이 발생하는 노드이다. leaf노드는 가상자산 유통망에서 최종 소비자로, F_supernode는 최종 소비자인 leaf 노드에게 가상자산을 판매하는 소매 유통업자로 볼 수있다.
F_supernode 방향으로 대규모 송신 트랜잭션이 발생하는 노드는 가상자산을 소매 유통하기 위한 의도가 있는 것으로 볼 수 있기 때문에 이러한노드는 해당 토큰을 발행하고 유통한 주체와 밀접한 관계를 가지고 있을가능성이 높다. 따라서, 이러한 지갑 주소는 가상자산 조사 시 우선적으로검토할 필요가 있다.
1. 수신 트랜잭션 수량이 상위 n%이내에 속하지 않으면서, 수신 트랜잭션의 유일한 상대방이 F_supernode인 노드
- 19 -
WITH percentileCont(n.totValIn, 0.9) AS top10PercentValue
MATCH (n)-[r:NET_TO]->() WITH n, r.netValue AS top10PercentValue
WHERE n.edgesOut >= 20
WITH collect(n) AS supernodes, top10PercentValue
UNWIND supernodes AS supernode
MATCH (supernode)-[r:NET_TO]->(leaf) WHERE size([(leaf)--() | 1]) = 1
AND NOT leaf:H_horizon
AND leaf.totValIn <= top10PercentValue
WITH supernode, collect(leaf) AS leafNodes
SET supernode.leafCount = size(leafNodes)
WITH supernode WHERE supernode.leafCount > 100
SET supernode:F_supernode
session.run( """MATCH (addr:addr {address: $address}) SET addr:G_genesis""", address=first_tx[3])
[그림 11] F_supernode 레이블 Cypher 쿼리
2.7 G_genesis
G_genesis 레이블을 가진 노드는 최초 트랜잭션의 송신 노드이다.
해당 레이블을 가진 노드는 가상자산 발행 초기 물량 배분을 추적하고집계하여 분석하기 위한 Cypher 쿼리에 유용하게 사용될 수 있으며, 트랜잭션을 그래프로 시각화해서 분석할 때 최초로 해당 토큰을 송신한 지갑주소 노드의 위치를 쉽게 파악할 수 있게 해준다.
[그림 12] G_genesis 레이블 Cypher 쿼리
- 20 -
session.run( """MATCH (addr:addr {address: $address}) SET addr:H_horizon""", address=last_tx[4])
MATCH (a:addr)-[r:NET_TO]->(b:addr)
2.8 H_horizon
H_horizon 레이블을 가진 노드는 최종 트랜잭션의 수신 노드이다.
해당 레이블을 가진 노드는 그래프 시각화 분석 시 마지막으로 해당 토큰을 수신한 지갑 주소 노드의 위치를 파악하여 해당 토큰의 전체 유통구조를 파악하는데 도움을 준다.
[그림 13] H_horizon 레이블 Cypher 쿼리
2.9 I_identifier
I_identifier 레이블을 가진 노드는 중앙화 거래소(CEX) 입금 전용 지갑주소의 거래 패턴을 나타내는 노드이다.
해당 레이블을 가진 노드는 n개9) 이상의 상대방과 수신 트랜잭션으로연결되어 있고, X_exchange 레이블(중앙화 거래소 관리 목적 지갑 주소거래 패턴)을 가진 노드와 송신 트랜잭션으로 연결된 노드이다.
I_identifier 레이블을 가진 지갑 주소 노드는 중앙화 거래소를 통해 해당지갑 주소의 소유자가 누구인지 확인할 수 있기 때문에 I_identifier 레이블은 가상자산 조세포탈 대응에서 매우 중요한 역할을 한다.
1. 분석 대상 토큰의 특성별로 적절한 값을 찾아 사용하여야 한다.
- 21 -
WHERE b.edgesOut = 1
WITH b, count(a) AS incomingFromA WHERE incomingFromA >= 5
MATCH (b)-[r2:NET_TO]->(c:addr) WITH b, c, count(b) AS incomingFromB
WHERE incomingFromB >= 1 AND c.edgesIn >= 10
SET b:I_identifier
MATCH (a:addr)-[r:NET_TO]->(b:addr) WHERE b.edgesOut = 1
WITH b, count(a) AS incomingFromA WHERE incomingFromA >= 5
MATCH (b)-[r2:NET_TO]->(c:addr) WITH b, c, count(b) AS incomingFromB
WHERE incomingFromB >= 1 AND c.edgesIn >= 10
SET c:X_exchange
[그림 14] I_identifier 레이블 Cypher 쿼리
2.10 X_exchange
X_exchange 레이블을 가진 노드는 n개 이상의 상대방 노드와 수신 트랜잭션으로 연결되어 있으면서, n개 이상의 I_identifier 레이블을 가진 노드와 수신 트랜잭션으로 연결되어 있는 노드이다.
해당 레이블을 가진 노드는 그래프에서 I_identifier 노드를 식별하는 기준으로 사용되며, 가상자산 이동 경로를 시각화해서 분석할 때 중앙화 거래소 관련 지갑 주소와 이와 관련된 경로를 조회하기 위해 사용된다.
[그림 15] X_exchange 레이블 Cypher 쿼리
- 22 -
제 3 장 그래프 데이터베이스 분석
제 1 절 AI 기반 이상 거래 패턴 분석
1. 그래프 신경망 모델(GAT)
본 연구에서 사용한 GAT(Graph Attention Network) 모델은 오토인코더구조(3개 층)로 되어 있다. GAT 모델은 그래프로 변환된 PICA 트랜잭션의 64차원 벡터를 입력으로 받아, 어텐션 메커니즘을 통해 노드 간의 중요도를 학습하며 차원 변환(64→256→32→64)을 거쳐 그래프의 구조와 각노드의 속성 정보를 학습한다. 학습된 GAT 모델은 입력 데이터를 재구성하고, 재구성된 벡터와 원본 입력 벡터 간의 오차(재구성 오차)를 계산하여 이상 거래 패턴을 탐지한다.
1.1 오토인코더(Auto Encoder)
오토인코더(Autoencoder)는 인코더와 디코더로 구성된 신경망 구조로,
입력 데이터를 저차원 공간으로 압축(인코딩)한 뒤 이를 다시 원래 차원으로 복원(디코딩)하는 과정을 통해 데이터의 주요 특징을 학습하는 비지도 학습 모델이다. 오토인코더는 학습 과정에서 재구성 오차(Reconstructi
on Error)를 최소화하는 것을 목표로 하며, 이때 손실 함수로는 주로 평균 제곱 오차(MSE)가 사용된다.
1.2 GAT 모델 구조 및 설정
GAT 모델의 각 층 사이에서 활성화 함수는 ELU를 사용하고, 드롭아웃은 0.3을 적용한다. 학습은 Adam 알고리즘(학습률=0.001)을 사용하며, 과
- 23 -
파라미터 값 설 명
최적화 설정
최적화 알고리즘 Adam 파라미터 업데이트 알고리즘
학습률 0.001 학습 속도 조절 값
가중치 감쇠 0.0005 가중치 업데이트 감쇠율
손실 함수 속성 MSE 예측 오차 계산 함수
학습 구성
최대 에폭 500 전체 데이터 학습 반복 횟수
드롭아웃 비율 0.3 학습 중 뉴런 비활성화 비율
적합 방지를 위해 가중치 감쇠(Weight Decay)는 0.0005를 적용한다.
[표 5] GAT 모델 파라미터
1.3 입력변수
GAT 모델의 입력 데이터는 그래프로 변환된 PICA 트랜잭션 데이터를Node2vec 기법으로 학습하여 생성한 64차원 임베딩 벡터 값이다.
1. GAT 모델 학습
2.1 그래프 임베딩
본 연구에서는 PICA 트랜잭션 데이터를 그래프로 변환한 후, Node2Vec
기법을 사용하여 각 노드의 속성 정보10)(35가지 속성)와 그래프 구조를학습하여 64차원 벡터로 임베딩하였다. Node2Vec에 적용된 파라미터는다음과 같다.
2. 그래프 데이터베이스 모델링 단계에서 지갑 주소 노드(addr)에 추가한 37가지 속성 중 firstTransaction과 lastTransaction을 제외한 나머지 35가지 속성
- 24 -
파라미터 값 설명
임베딩 설정
dimensions 64 임베딩 차원 수
window 10 컨텍스트 윈도우 크기
min_count 1 최소 등장 횟수
batch_words 4 배치 크기
랜덤워크 설정
walk_length 30 랜덤 워크 길이
num_walks 200 랜덤 워크 횟수
workers 4 병렬 처리 시 사용되는 워커 수
p 1 이전 노드 반환 경향(균형)
q 1 DFS, BFS 탐색 방식(균형)
[표 6] Node2Vec 파라미터
2.2 모델 학습
본 연구의 GAT 모델은 3개의 층(Layer)으로 구성되어 학습을 수행한다.
첫 번째 층에서는 각 노드의 64차원 벡터를 입력받아 8개의 어텐션 헤드를 통해 이웃 노드의 중요도를 반영하며 학습한 뒤, 256차원 벡터를 출력한다. 두 번째 층에서는 첫 번째 층의 256차원 벡터를 입력받아 1개의 어텐션 헤드를 통해 학습하여 32차원으로 압축한다. 마지막 층에서는 두 번째 층의 32차원 벡터를 입력받아 1개의 어텐션 헤드를 통해 원본 데이터와 동일한 64차원 벡터로 복원한다.
모델 학습은 총 1,000 에폭(Epoch) 동안 진행되며, 재구성 오차를 최소화하기 위해 평균 제곱 오차(MSE)를 손실 함수로 사용한다.
- 25 -
1. GAT 기반 이상 거래 패턴 탐지
본 연구에서는 GAT 모델의 재구성 오차를 기반으로 이상 거래 패턴을탐지하였다. 재구성 오차는 GAT 모델이 입력 벡터를 압축한 후 복원한결과와 원본 입력 벡터 간의 차이로 계산되며, Lei Yu(2023)는 이 차이가클수록 해당 노드가 자금세탁과 관련된 비정상적 거래 패턴(Peeling Chai
n, 순환 거래, 거래 폭발 등)을 보인다고 밝혔다. 이러한 패턴은 가상 자산을 이용한 조세 포탈에서도 유사하게 나타날 수 있기 때문에 재구성 오차는 조세 포탈 위험 거래 탐지를 위한 지표로 활용할 수 있다.11)
본 연구에서는 각 노드별로 계산된 재구성 오차를 z-score로 정규화한후, 정규화된 재구성 오차가 z-score 2(상위 5% 수준)를 초과하는 노드를이상 노드(Anomalous Node)로 구분하였다.
2. 머신러닝 모델(XGBoost)
본 연구에서는 GAT 모델이 이상 노드(Anomalous Node)를 구분하고 재구성 오차를 계산하는데 영향을 미치는 주요 요인을 분석하고 이를 정량적으로 평가하기 위해 두 가지 머신러닝 모델(XGBoost 알고리즘 기반 분류 모델 및 회귀 모델)을 사용하였다.
분류 모델은 GAT 모델의 이상 노드 구분에 영향을 미치는 각 지갑 주소 노드의 주요 속성을 분석하는 데 사용되었으며, 회귀 모델은 재구성오차 계산에 중요한 영향을 미치는 각 지갑 주소 노드의 주요 속성을 분석하는 데 활용되었다.
3. Lei Yu, Fengjun Zhang, Tianqi, Jiajia Ma, Li Yang, Yuanzhe Yang, Wei
Jia, “Who Are the Money Launderers? Money Laundering Detection on
Blockchain via Mutual Learning-Based Graph Neural Network", IJCNN
(2023)
- 26 -
구 분 파라미터 값 설 명
트리 구조 최적화
n_estimators 300 트리 개수
max_depth 6 트리의 최대 깊이
min_child_weight 2 최소 자식 노드 가중치
gamma 0.1 트리 분할 기준
학습 제어
learning_rate 0.05 학습률
subsample 0.8 샘플링 데이터 비율
colsample_bytree 0.8 샘플링 특성 비율
모델 정규화
reg_alpha 0.1 L1 정규화
reg_lambda 1 L2 정규화
불균형 처리 scale_pos_weight 계산 양성 클래스 가중치 비율
각 모델의 설명 변수로는 지갑 주소 노드(addr)의 35가지 속성 정보, 각노드의 특수 거래 패턴 레이블 해당 여부(10가지), 커뮤니티 해당 여부(13
가지), 그리고 그래프 구조와 속성 정보를 학습하여 그래프 임베딩된 64
차원 벡터와 중심성 벡터 간의 코사인 유사도를 포함한 총 59가지 정보를사용하였다.
4.1 분류 모델(Classification Model)
분류 모델은 GAT 모델이 이상 노드(Anomalous Node)를 구분할 때 중요하게 영향을 미치는 지갑 주소 노드의 속성 정보를 분석하는 데 사용된다. 본 연구에서 사용된 XGBoost 분류 모델의 파라미터는 다음과 같다.
[표 7] XGBoost 분류 모델 파라미터
- 27 -
4.2 회귀 모델(Regression Model)
회귀 모델은 GAT 모델이 재구성 오차를 계산할 때 중요한 영향을 미치는 지갑 주소 노드의 속성 정보를 분석하는 데 사용된다. 회귀 모델의 파라미터는 기본 값을 사용한다.
1. XGBoost 모델 학습
분류 모델의 타깃(target)은 GAT 모델로 탐지한 재구성 오차에 따른 이상 노드 해당 여부(anomaly_yn)이며, 회귀 모델의 타깃은 GAT 모델로탐지한 노드별 재구성 오차 측정값이다.
분류 모델과 회귀 모델의 설명 변수는 다음과 같다. (1) 지갑 주소 노드의 35가지 속성 값, (2) 10가지 특수 거래 패턴 레이블 해당 여부를 나타내는 이진 값, (3) 루뱅(Louvain) 알고리즘으로 구분한 13가지 커뮤니티해당 여부를 나타내는 이진 값, (4) 지갑 주소 노드 벡터와 중심성 벡터(
Centrality Vector) 간의 코사인 유사도(Cosine Similarity)이다. 모든 설명변수는 StandardScaler를 적용하여 평균 0, 표준편차 1로 정규화하였다.
분류 모델과 회귀 모델의 학습 데이터는 훈련 세트와 테스트 세트를 8:2
비율로 분할하였다. 분류 모델에서는 클래스 불균형 문제를 해결하기 위해 scale_pos_weight를 적용하였으며, 이때 가중치(weight)는 정상 노드수를 이상 패턴 노드 수로 나눈 값을 사용하였다.
2. XGBoost 기반 재구성 오차 발생 원인 분석
본 연구에서는 XGBoost 분류 모델을 사용하여 GAT 모델이 탐지한 재구성 오차에 따른 이상 노드(Anomalous Node) 구분과 재구성 오차 측정
- 28 -
설명 변수 분류 모델 회귀 모델
Importance SHAP Value Importance
centralityBetweenness 0.1393 1.0241 0.3097
uniqueEdgesOut 0.0511 0.2472 0.1204
avgGasIn 0.0157 0.3118 0.0813
totGasOut 0.0230 0.6823 0.0611
cycles 0.1343 4.8089 0.0507
Confusion Matrix
PREDICT
POSITIVE NEGATIVE
ACTUAL
POSITIVE TP (902, 10.53%) FN (105, 1.23%)
NEGATIVE FP (177, 2.07%) TN (7378, 86.17%)
에 영향을 미치는 지갑 주소 노드의 속성 정보를 분석하기 위해 각 속성의 중요도를 정량적으로 측정하였다.
[표 8] XGBoost 분류 모델 혼동 행렬
분류 모델은 학습 데이터의 88.24%가 음성 클래스인 클래스 불균형 상황에서도, 소수 클래스인 양성 클래스에 대해 89.60%의 높은 재현율(Reca
ll)과 83.58%의 정밀도(Precision)를 나타냈다. 분류 모델은 F1 Score(0.86
49)와 AUC(0.9954)를 나타냈으며, 이는 해당 모델이 클래스 가중치 조정을 통해 다수 클래스인 음성 클래스로 편향되지 않고 소수 클래스인 양성클래스의 특징도 효과적으로 학습했음을 보여준다.
회귀 모델은 매우 높은 수준의 결정계수(R²)(0.9633)를 달성했으며, 분류모델과 회귀 모델에 사용된 설명 변수의 중요도(Importance)와 SHAP12)
값은 다음과 같다.
1. SHAP(Shapley Additive Explanations): 협력 게임 이론의 샤플리 값을 기반으로 특성 조합에 따른 모델 예측 변화를 계산해 각 특성의 기여도를 공정하게 산출하는 방법
- 29 -
dijkstra 0.0107 0.1806 0.0476
uniqueEdgesIn 0.0512 0.0728 0.0429
cosine_similarity 0.0228 0.0570 0.0382
distance 0.0120 0.1211 0.0335
centralityPagerank 0.0644 0.1064 0.0283
community_D 0.0191 0.3691 0.0180
centralityCloseness 0.0176 0.2488 0.0166
avgValIn 0.0100 0.1256 0.0142
gasEfficiencyOut 0.0194 0.1188 0.0129
community_G 0.0112 0.1900 0.0091
avgValDaily 0.0076 0.0281 0.0088
avgGasOut 0.0758 0.1140 0.0084
period 0.0141 0.3900 0.0082
totGasIn 0.0020 0.0014 0.0068
totValIn 0.0049 0.0433 0.0063
avgValOut 0.0133 0.1842 0.0059
uniqueValOut 0.0072 0.2042 0.0057
lifetime 0.0035 0.0506 0.0057
community_L 0.0092 0.0629 0.0052
totCntOut 0.0126 0.0216 0.0049
avgCntDaily 0.0076 0.1342 0.0048
uniqueValIn 0.0635 0.0170 0.0045
daysCntOutlier 0.0112 0.1422 0.0045
totCntIn 0.0083 0.0844 0.0043
returns 0.0077 0.1839 0.0042
edgesOut 0.0073 0.0136 0.0038
edgesIn 0.0062 0.0223 0.0035
daysGasOutlier 0.0090 0.0136 0.0029
[표 9] GAT 모델 이상 거래 패턴 탐지 요인 분석 결과
- 30 -
GAT 모델의 이상 노드(Anomalous Node) 구분과 GAT 모델이 측정한재구성 오차의 요인 분석을 위한 분류 모델과 회귀 모델에서 매개중심성(centralityBetweenness)의 중요도(Importance)는 각각 0.2021, 0.3607로가장 높은 수치를 나타냈다. 이는 다른 노드들 사이의 최단 경로에 해당노드가 나타나는 빈도가 GAT 모델의 이상 노드 구분과 재구성 오차 계산에 가장 중요한 영향을 미친다는 것을 의미한다. 또한 이 결과는 PICA
트랜잭션 그래프에서 대부분의 노드가 일정 수준의 매개중심성을 가지고있음을 시사한다.
같은 방식으로 분류 모델과 회귀 모델에서 높은 중요도 수치를 나타낸나머지 코사인 유사도(cosine_similarity)나 유일 송신 엣지 개수(uniqueEd
gesOut), 송신 엣지 개수(EdgesOut), 송신 트랜잭션 가스 총 허용량(totG
asOut), 순환 거래 횟수(Cycles)도 GAT 모델의 이상 노드 구분과 재구성오차 계산에 중요한 영향을 미치고 있다는 사실과 이러한 속성 값들이 대부분의 노드에서 비슷한 수준으로 나타나고 있다는 사실을 알 수 있다.
분석 결과에서 주목할 만한 점은 코사인 유사도(cosine_similarity)가 중요도(0.0774)에 비해 매우 높은 SHAP 값(4.5161)을 기록했다는 것이다.
이는 코사인 유사도가 단독으로도 이상 패턴 구분에 영향을 미칠 뿐만 아니라, 다른 특성들과의 상호작용을 통해 오분류를 줄이고 새로운 이상 패턴을 발견하는 데 중요한 보조적 역할을 한다는 것을 의미한다. 이러한결과는 GAT 모델이 이상 거래 패턴 노드 분류와 재구성 오차를 계산할때 특성들 간의 상호작용, 특히 코사인 유사도와의 조합을 중요하게 고려한다는 것을 시사한다.
분류 모델과 회귀 모델은 대부분의 특수 거래 패턴 레이블과 커뮤니티속성을 중요하게 고려하지 않았으나, 특수 거래 패턴 레이블 중 B_pocket
(0.0823, 0.0237)과 커뮤니티 중 community_G(0.0081, 0.0076)만이 상대적으로 높은 중요도를 나타냈다는 것도 주목할 만한 점이다. 이는 높은 이상 거래 패턴 수치를 가진 노드가 특정 커뮤니티(G)나 특수 거래 패턴 레
- 31 -
속성 정보 설명력 주요 영향 변수
centralityBetweenness 0.6636
totCntOut (0.5140)
edgesIn (0.1545)
totCntDays (0.1061)
cosine_similarity 0.5182
dijkstra (-0.6957)
centralityBetweenness (-0.0687)
avgGasOut (0.0417)
uniqueEdgesOut 0.8621 edgesOut (0.5401)
totCntOut (0.4373)
edgesOut 0.8274
totCntOut (0.3677)
uniqueEdgesOut (0.2878)
avgCntDaily (0.2034)
totGasOut 0.8963 avgGasOut (0.8370)
edgesOut (0.1362)
cycles 0.8964 totGasOut (0.8408)
edgesOut (0.1362)
이블(B_pocket)에 집중되어 있을 가능성을 시사한다.
1. XGBoost 기반 속성별 상관관계 분석
GAT 모델이 탐지한 이상 거래 패턴에 영향을 미친 주요 속성을 심층적으로 분석하기 위해 GAT 모델 학습에 사용된 59개 속성 중 하나를 타깃으로 하고 나머지 58개 속성을 설명 변수로 하여 총 59개의 XGBoost 회귀 모델을 구현하였다. 각 회귀 모델의 타깃 예측 가능성(R²)과 나머지 5
8개 속성의 가중치를 분석하여 주요 속성과 나머지 속성 간의 상호 연관성을 파악하고, 이를 바탕으로 각 속성이 GAT 모델의 이상 거래 패턴탐지에 미친 영향을 나머지 속성의 가중치와 예측 가능성으로 수치화하여설명하고자 하였다. 가중치(Importance)의 방향은 단순선형회귀(Simple Li
near Regression)모델의 기울기로 확인하였다.
[표 10] 이상 거래 패턴 주요 요인 속성 간 상관관계 분석
- 32 -
7.1 centralityBetweennes 모델
매개중심성(centralityBetweenness) 모델의 설명력(R²)은 0.6636으로 다른 모델들에 비해 낮은 수치를 나타냈다. 이는 PICA 트랜잭션 그래프 데이터베이스에서 각 노드의 매개중심성이 다른 속성들로는 충분히 설명되지 않는 독특한 패턴을 보인다는 것을 의미한다.
매개중심성 모델에서는 송신 트랜잭션 횟수(totCntOut, 0.5140), 수신 트랜잭션 상대방의 수(edgesIn, 0.1545), 트랜잭션 발생 일수(totCntDays, 0.1
1. 순으로 높은 가중치를 나타냈으며, 단순선형회귀모델로 측정된 각주요 속성의 기울기는 totCntOut(+), edgesIn(+), totCntDays(+)이다.
이를 통해 송신 트랜잭션이나 수신 트랜잭션 상대방 노드의 수, 트랜잭션 발생 일수가 증가함에 따라 해당 노드의 매개중심성도 증가하는 경향이 있지만 그 관계가 강하지 않다는 사실을 알 수 있다.
7.2 cosine_similarity 모델
코사인 유사도(cosine_similarity) 모델의 설명력(R²)은 0.5182로 다른 모델들에 비해 매우 낮은 수치를 나타냈다. 이는 PICA 트랜잭션 그래프 데이터베이스에서 각 노드의 중심성 벡터와의 코사인 유사도가 다른 속성들로는 충분히 설명되지 않는 독특한 패턴을 보인다는 것을 의미한다.
코사인 유사도 모델에서는 가중치를 고려한 최단 경로 거리(dijkstra, 0.6
957)가 압도적으로 높은 영향력을 보였으며, 다음으로 매개중심성(centrali
tyBetweenness, 0.0687)과 송신 트랜잭션 평균 가스 허용량(avgGasOut, 0
.0417) 순으로 높은 영향력을 나타냈다. 단순선형회귀모델로 측정된 각 주요 속성의 기울기는 dijkstra(-), centralityBetweenness(-), avgGasOut(+)
이다.
- 33 -
이를 통해 네트워크에서 각 노드의 가중치를 고려한 최단 경로 거리가짧을수록, 매개중심성 낮을수록, 그리고 송신 트랜잭션 평균 가스 허용량이 많을수록 코사인 유사도가 커지는 경향이 있지만 그 관계는 약하다는것을 알 수 있다.
7.3 uniqueEdgesOut 모델
유일 송신 엣지 개수(uniqueEdgesOut) 모델의 설명력(R²)은 0.8621로 높은 수치를 나타냈다. 이는 PICA 트랜잭션 그래프 데이터베이스에서 각노드의 uniqueEdgesOut이 다른 속성정보들로 잘 설명되는 일관된 패턴을보인다는 것을 의미한다.
uniqueEdgesOut 모델에서는 송신 트랜잭션 상대방의 수(edgesOut, 0.54
01)와 송신 트랜잭션 횟수(totCntOut, 0.4373)가 주요 영향 요인으로 나타났다. 단순선형회귀모델로 측정된 각 주요 속성의 기울기는 edgesOut(+), t
otCntOut(+)이다.
이를 통해 송신 트랜잭션 상대방의 수와 송신 트랜잭션 발생 횟수가 증가할수록 유일 송신 엣지 개수도 증가하는 경향이 있다는 사실과 대부분의 송신 트랜잭션이 각 상대방 노드와 한 번씩만 발생하는 경향이 있음을알 수 있다.
7.4 edgesOut 모델
송신 트랜잭션 상대방의 수(edgesOut) 모델의 설명력(R²)은 0.8274로 높은 수치를 나타냈다. 이는 PICA 트랜잭션 그래프 데이터베이스에서 각노드의 송신 트랜잭션 상대방의 수가 다른 특성들로 잘 예측된다는 것을의미한다.
- 34 -
edgesOut 모델에서는 송신 트랜잭션 횟수(totCntOut, 0.3677), 유일 송신엣지 개수(uniqueEdgesOut, 0.2878), 일평균 트랜잭션 횟수(avgCntDaily,
0.2034)가 주요 예측 변수로 확인되었다. 단순선형회귀모델로 측정된 각주요 속성의 기울기는 totCntOut(+), uniqueEdgesOut(+), avgCntDaily(+)
이다.
이를 통해 송신 트랜잭션 횟수, 유일 송신 엣지 개수, 일평균 트랜잭션횟수가 증가할수록 송신 트랜잭션 상대방의 수도 증가하는 경향이 있다는사실을 알 수 있다.
7.5 totGasOut 모델
송신 트랜잭션 가스 허용량(totGasOut) 모델의 설명력(R²)은 0.8963으로높은 수치를 나타냈다. 이는 PICA 트랜잭션 그래프 데이터베이스에서 각노드의 송신 트랜잭션 가스 허용량이 다른 특성들로 잘 예측됨을 의미한다.
totGasOut 모델에서는 송신 트랜잭션 평균 가스 허용량(avgGasOut, 0.8
370)이 압도적으로 높은 예측력을 보였으며, 다음으로 송신 엣지 개수(ed
gesOut, 0.1362)가 주요 예측 변수로 확인되었다. 단순선형회귀모델로 측정된 각 주요 속성의 기울기는 avgGasOut(+), edgesOut(+)이다.
이를 통해 송신 트랜잭션 평균 가스 허용량, 송신 엣지 개수가 증가할수록 송신 트랜잭션 가스 허용량이 증가하는 경향이 있다는 사실을 알 수있다.
7.6 cycles 모델
순환 거래 횟수(cycles) 모델의 설명력(R²)은 0.8964로 높은 수치를 나타냈다. 이는 PICA 트랜잭션 그래프 데이터베이스에서 각 노드의 cycles가
- 35 -
다른 특성들로 잘 예측됨을 의미한다.
cycles 모델에서는 송신 트랜잭션 가스 허용량(totGasOut, 0.8408)이 압도적으로 높은 예측력을 보였으며, 다음으로 송신 트랜잭션 상대방의 수(
edgesOut, 0.0794)가 주요 예측 변수로 확인되었다. 단순선형회귀모델로측정된 각 속성의 기울기는 허용량 totGasOut(+), edgesOut(+) 이다.
이를 통해 송신 트랜잭션 가스 허용량, 송신 트랜잭션 상대방의 수가 증가할수록 순환 거래 횟수가 증가하는 경향이 있다는 것을 알 수 있다.
7.7 종합 결론
XGBoost 속성별 회귀 모델을 통해 GAT 모델의 이상 거래 패턴 탐지에영향을 미친 주요 속성들이 다른 속성들과 맺고 있는 관계를 정량적으로측정하여 파악할 수 있다.
이를 통해, GAT 모델이 탐지한 이상 거래 패턴의 의미를 심도 있게 파악함으로써 이상 거래 패턴의 정도를 나타내는 재구성 오차를 조세포탈위험도 평가 관점에서 해석할 수 있다.
예를 들면, XGBoost 회귀 모델 결과에 따르면 재구성 오차가 큰 지갑주소는 유일 송신 엣지 개수가 비정상적일 가능성이 높은데, XGBoost 속성별 회귀 모델 분석 결과 유일 송신 엣지 개수가 비정상적인 경우는 송신 트랜잭션 상대방의 수와 송신 트랜잭션 발생 횟수에 비해 매우 많거나적은 경우를 의미한다.
이러한 분석 결과를 통해 이상 거래 패턴을 나타내는 지갑 주소는 송신트랜잭션 상대방 수와 횟수가 많음에도 불구하고 해당 지갑 주소를 통해서만 토큰을 수신하고 있는 상대방 지갑 주소는 적은 노드라고 추정할 수있으며, 이는 해당 노드와 연결된 지갑 주소에서 정상적인 거래 패턴을
- 36 -
거래 유형 지갑 주소 지갑 유형 주요 특징
유형1
0xa5025fa
ba6e70b84
f74e9b111
3e5f7f4e7f
4859f
contract
(자금세탁 의심지갑) Mulitsender.ap
p 서비스 지갑 주소. 다수 지갑 주
소로 토큰을 한꺼번에 전송
유형2
0xfea2c6d9
6f0bd4cd4
d638bcefa
7968146c7
4df37
address
(토큰 판매대가 수취 지갑 주소) 거
래소로부터 대량 이더리움 수신 트
랜잭션 발생. 다수의 지갑 주소로부
터 테더 대량 수신 트랜잭션 발생
유형3
0x81f67dd
424e126c0
0c4212cea
c95747e57
539e19
contract
(중앙화 거래소 입금 전용 지갑 주
소) 다수의 지갑 주소로부터 수신
트랜잭션이 발생하고 거래소 관리
지갑 주소로 송신 트랜잭션 발생(sw
eep, 자동 잔액 정리 기능 사용)
벗어나 비정상적인 복잡한 거래가 발생하고 있다는 것을 나타는 것으로조세포탈 위험 징후를 나타내는 것으로 볼 수 있다.
1. 이상 거래 패턴 지갑 주소 사례 연구
본 연구는 이상 거래 패턴 지갑 주소의 식별과 재구성 오차 측정을 위해Node2Vec, GAT, XGBoost 등 AI 학습 모델을 활용하였다. 이를 통해 이상 거래 패턴 지갑 주소를 선별하고 거래 유형별로 분류하였으며, GAT
모델의 재구성 오차가 높은 지갑 주소들 중에서 서로 다른 거래 유형을보이는 3개의 대표 사례를 선정하여 이더스캔(Etherscan)의 정보를 바탕으로 심층 분석을 진행하였다.
[표 11] 이상 거래 패턴 지갑 주소 유형별 특징
- 37 -
구분 유형1 유형2 유형3
id 3815 2183 3539
address
0xa5025faba6e7
0b84f74e9b111
3e5f7f4e7f4859f
0xfea2c6d96f0b
d4cd4d638bcef
a7968146c74df
37
0x81f67dd424e
126c00c4212ce
ac95747e57539
e19
labels F_supernode /
E_passthrough B_pocket
community E D E
totalCentrality 0.146209892 0.09808681 0.061149543
edgesIn 1 1 3
edgesOut 958 1 0
totCntIn 4 1 3
totCntOut 958 4 0
totValIn 43,260 43,305 158
totValOut 43,260 43,260 0
avgValIn 10,815 43,305 53
avgValOut 45 10,815 0
daysCntOutlier 0 0 0
daysValOutlier 1 1 0
totCntDays 1 1 1
daysGasOutlier 1 1 1
totGasIn 28,341,690 79,629 240,000
totGasOut 6,824,241,090 28,341,690 0
avgGasIn 7,085,423 79,629 80,000
avgGasOut 7,123,425 7,085,423 0
gasEfficiencyIn 0.001526 0.543834 0.000658
gasEfficiencyOut 0.000006 0.001526 0.000000
- 38 -
lifetime 1 1 1
avgCntDaily 958 4 0
avgValDaily 43,260 43,260 0
volatility 0.002660 0.000777 0.000000
period 0.001039 0.2 0.333333
distance 5 4 5
dijkstra 5 6 7
uniqueEdgesIn 1 0 3
uniqueEdgesOut 605 1 0
uniqueValIn 43,260 0 158
uniqueValOut 27,290 43,260 0
cycles 352 0 0
returns 0 0 0
centralityDegree 0.249609 0.001042 0
centralityPagerank 0.000123 0.000000 0.000476
centralityBetweenness 0.091590 0.091528 0
centralityCloseness 0.243516 0.299776 0.244121
cosine_similarity 0.264879 0.287963 0.498431
GAT_error 9.813877 8.588877 8.152791
GAT_anomaly y y y
[표 12] 이상 거래 패턴 지갑 주소의 속성 정보
8.1 (유형1) 지갑 주소 사례 연구
(유형1) 지갑 주소는 다수의 지갑 주소로 토큰을 일괄 전송할 수 있는Multisender.app의 스마트 컨트랙트 주소이다. 이 서비스는 하나의 트랜잭션으로 여러 수신자에게 토큰을 동시에 분배해준다.
- 39 -
8.1.1 주요 속성 값 분석
(유형1) 지갑 주소는 하루 동안 4건의 수신 트랜잭션과 958건의 송신 트랜잭션이 발생했다. 특히 송·수신 트랜잭션 총 수량은 43,260으로 동일하나, 평균 수신 트랜잭션 수량이 10,815인 것에 비해 평균 송신 트랜잭션수량은 45로 현저히 낮았다. 이는 대량의 토큰을 한 번에 받아 다수의 수신자에게 소량의 토큰을 나누어 전송하는 멀티센더 서비스의 특징과 일치하는 거래 패턴이다.
거래 패턴을 살펴보면, 이 지갑 주소는 수신 유일 송신 엣지 개수(uniqu
eEdgesIn) 1개와 유일 수신 엣지 개수(uniqueEdgesOut) 605개로 전형적인 자금 분배 구조를 보였다. 또한 352개의 지갑 주소와 상호간 송수신거래(cycles)가 발생했으며, 트랜잭션 수량의 변동성(volatility)은 0.002660
으로 매우 안정적이었다. 특히 가스 허용량은 수신 트랜잭션에서 28,341,6
90, 송신 트랜잭션에서 6,824,241,090으로 일반적인 다른 노드와 비교하여매우 높은 수준을 보였다.
이 지갑 주소는 재구성 오차(GAT_error)가 9.813877로 매우 높게 나타났다. 이는 소수의 트랜잭션으로 대량의 토큰을 받고, 다수의 트랜잭션을통해 소량의 토큰을 보내고 있으며, 일반적인 거래 대비 높은 가스 허용량을 보이고, 자동화된 방식으로 짧은 시간 내 집중적인 거래가 발생하는등 멀티센더 서비스의 특징적인 패턴이 반영된 것으로 보인다.
8.1.2 지갑 주소 정보 분석
이더스캔에서 조회 결과에 따르면 (유형1) 지갑 주소는 컨트랙트(Contra
ct) 유형으로 분류되어 있으며 Multisender.app 태그가 부여되어 있다. 이는 이 주소가 일반적인 개인 지갑 주소가 아닌, 토큰의 자동 분배 기능을수행하는 스마트 컨트랙트임을 보여준다.
- 40 -
function () public payable {
address _impl = implementation();
require(_impl != address(0));
bytes memory data = msg.data;
assembly {let result : delegatecall(gas, _impl, add(data, 0x20),
mload(data), 0, 0)
let size : returndatasize
let ptr : mload(0x40) returndatacopy(ptr, 0, size)
switch result case 0 { revert(ptr, size) } default { return(ptr, size) }}}
[그림 16] 이상 거래 패턴 유형1 지갑 주소 정보
8.1.3 컨트랙트 소스코드 분석
(유형1) 지갑 주소의 스마트 컨트랙트는 수신한 토큰을 다수의 수신자에게 자동으로 분배하는 기능을 수행한다. 이러한 컨트랙트 기능은 앞서 관찰된 거래 패턴, 즉 소수의 대량 수신 트랜잭션과 다수의 소량 송신 트랜잭션이 발생하는 현상을 잘 설명해준다. 해당 스마트 컨트랙트의 소스코드 내용은 다음과 같다.
[그림 17] 이상 거래 패턴 유형1 컨트랙트 소스코드 일부
- 41 -
8.1.4 트랜잭션 내역 분석
(유형1) 지갑 주소의 트랜잭션은 대량 수신 트랜잭션 이후 다수의 소량송신 트랜잭션이 연속적으로 발생하는 특징을 가진다. 각 송신 트랜잭션은 Multisend Token 메소드를 사용하여 동일한 수량의 토큰을 여러 지갑주소로 분배한다. 이는 다수의 지갑 주소로 소량의 토큰을 일괄 전송하는에어드롭(Airdrop) 서비스의 전형적인 특징을 나타낸다.
[그림 18] 이상 거래 패턴 유형1 트랜잭션 내역
8.2 (유형2) 지갑 주소 사례 연구
(유형2) 지갑 주소는 다수의 지갑 주소로부터 이더리움(ETH)과 테더(U
SDT)를 수신하고, 다수의 수신자에게 특정 토큰을 분배하는 거래 패턴을보인다. 이는 토큰 판매 대금을 결제 수단으로 주로 사용되는 이더리움이나 테더로 수취하고, 특정 토큰을 다수의 수신자에게 판매하는 것으로 해석될 수 있으므로 (유형2) 지갑 주소는 특정 토큰의 판매자 역할을 하고있는 것으로 볼 수 있다.
8.2.1 주요 속성 값 분석
(유형2) 지갑 주소는 하루 동안 1건의 입금(43,305)과 4건의 출금(총 43,2
- 42 -
1. 거래를 기록했다. 평균 거래액은 입금이 43,305, 출금이 10,815로 큰차이를 나타낸다.
네트워크 분석 결과, 단일 입금 지갑으로의 고유 출금 연결(uniqueEdges
Out)이 1개 확인되었으며, 순환 거래(cycles)는 발생하지 않았다. 거래 변동성(volatility)은 0.000777로 매우 안정적인 거래 패턴을 나타냈다. 가스사용량은 입금 거래 79,629, 출금 거래 28,341,690으로 출금 시 현저히 높은 수준을 기록했다.
이 지갑 주소의 거래 패턴은 대량 자금을 일시적으로 보관했다가 재분배하는 중개 역할을 나타낸다. 특히 네트워크 내 영향력을 나타내는 중앙성지표(centralityDegree, centralityPagerank)가 매우 낮은데, 이는 해당 지갑이 지속적인 거래 관계 형성 없이 단발성 중개 거래에 주로 사용되었음을 시사한다.
8.2.2 지갑 주소 정보 분석
(유형2) 지갑 주소는 이더스캔에서 Address로 분류된 일반 개인 지갑으로, 특별한 태그나 거래소 연관성이 없다.
[그림 19] 이상 거래 패턴 유형2 지갑 주소 정보
- 43 -
8.2.3 트랜잭션 내역 분석
(유형2) 지갑 주소의 거래 내역은 크게 두 시기로 구분된다. 2021년 1월13일에는 약 100개의 서로 다른 지갑으로부터 100∼5,000 USDT 규모의입금이 집중되어 총 300,000 USDT가 수신되었다. 2020년에는 39.98 ETH
, 150 ETH 등 대규모 이더리움 입금이 발생했다. 이렇게 수신된 자금은Multisend Token 메소드를 통해 다수의 수신자에게 분배되었다.
이러한 여러 암호화폐에 대한 대량 입금과 재분배 패턴은 이 지갑이 다양한 토큰의 판매 대금을 중개하는 역할을 수행했음을 증명한다.
[그림 20] 이상 거래 패턴 유형2 트랜잭션 내역
8.3 (유형3) 지갑 주소 사례 연구
(유형3) 지갑 주소는 거래소의 입금 전용 중간 경유 지갑으로, 다수의 고객 지갑으로부터 입금받은 자금을 거래소 메인 지갑으로 자동 이체하는기능을 수행한다. 이 지갑에는 B_pocket 레이블이 지정되어 있으며, 수신트랜잭션 3건만 존재하고 출금 거래는 없는 특징을 보인다.
- 44 -
8.3.1 주요 속성 값 분석
(유형3) 지갑 주소는 하루 동안 3건의 수신 트랜잭션만 발생했으며 송신트랜잭션은 전혀 없었다. 수신 트랜잭션은 모두 uniqueEdgesIn이었다. 트랜잭션 수량의 변동성(volatility)은 0으로 일정한 패턴을 보였다. 또한, ce
ntralityDegree 0, centralityPagerank 0.000476, centralityBetweenness 0으로 중심성 지표가 매우 낮은 특징을 보였다.
8.3.2 지갑 주소 정보 분석
유형3 지갑 주소는 이더스캔에서 Contract로 분류되어 있으며, 컨트랙트생성자는 업비트(Upbit) 거래소로 명시되어 있다.
[그림 21] 이상 거래 패턴 유형3 지갑 주소 정보
8.3.3 이더스캔 컨트랙트 소스코드
(유형3) 지갑 주소의 컨트랙트 소스코드에는 고객 자산이 입금되면 이를자동으로 정리(sweep)하여 거래소의 관리 지갑으로 이동시키는 기능이구현되어 있다.
- 45 -

# Palkeoramix decompiler.

def storage:
stor0 is addr at storage 0
def _fallback() payable: # default function
revert
def sweep(address _token, uint256 _amount): # not payable
require ext_code.size(stor0)
call stor0.sweeperOf(address token) with:
gas gas_remaining - 50 wei
args _token
require ext_call.success
delegate addr(ext_call.return_data) with:
funct call.data[0 len 4]
gas gas_remaining - 50 wei
args call.data[4 len calldata.size - 4]
require delegate.return_code
return bool(delegate.return_data[0])
[그림 22] 이상 거래 패턴 유형3 컨트랙트 소스코드
8.3.4 이더스캔 트랜잭션 내역
(유형3) 지갑 주소의 트랜잭션을 분석한 결과, 2019년부터 2022년까지의모든 트랜잭션이 Sweep 메소드를 통해 수행되었다. 발신자는 Upbit2와 U
pbit 14로 식별되는 거래소 관리 지갑으로 확인되었으며, ETH 거래액은모두 0으로 기록되었다. 이는 이 지갑이 주로 ERC-20 토큰의 잔액을 정리하는 용도로 사용된다는 것을 나타낸다.
중앙화 거래소는 주기적으로 sweep 기능을 실행하여 고객 입금용 지갑에 보관된 ERC-20 토큰을 메인 지갑으로 자동 이전하는 방식으로 자산을 관리한다. 이러한 트랜잭션 패턴은 컨트랙트 소스코드에 구현된 swee

- 46 -
p 함수의 내용과 일치한다.
[그림 23] 이상 거래 패턴 유형3 트랜잭션 내역
1. 이상 거래 패턴 기반 조세포탈 위험도 분석
본 연구에서는 오토인코딩 기법을 사용한 GAT 모델로 이상 노드(Anom
alous Node)를 구분하고 재구성 오차를 측정하였으며, 이를 XGBoost 기반 분류 모델과 회귀 모델로 분석하여, GAT 모델이 측정한 재구성 오차의 발생 원인을 지갑 주소 노드의 속성 정보 가중치로 설명하였다. 또한,
GAT 모델로 탐지한 이상 거래 패턴을 심도 있게 분석하기 위해 XGBoos
t 기반 속성별 회귀 모델을 구현하여 GAT 모델의 이상 거래 패턴 탐지에 영향을 미친 주요 속성과 나머지 속성 간 상관관계를 분석하고, 재구성 오차가 큰 지갑 주소는 실제 사례를 연구하였다.
이러한 연구 결과를 바탕으로 오토인코딩 기법을 사용한 GAT 모델로측정한 이상 거래 패턴(재구성 오차)이 조세포탈 위험도 평가 관점에서어떻게 해석될 수 있는지 연구하였다.
GAT 모델의 이상 거래 패턴 노드와 재구성 오차를 분석한 XGBoost 분류 모델과 회귀 모델에서 매개중심성(centralityBetweenness)의 중요도(im
portance)는 각각 0.2021, 0.3607로 가장 높은 수치를 나타냈다. Shlomit(2
- 47 -
022)은 자금세탁 조직이 매개중심성이 높은 지갑 주소를 통해 자금 출처를 은닉한다는 사실을 보여 주었다. 본 연구에서 GAT 모델로 탐지한 이상 거래 패턴 수치가 높은 지갑 주소들은 매개중심성이 높은 경향이 있었으며, 이러한 경향은 자금세탁이나 조세포탈에서 나타나는 자금 출처 은닉의 거래 패턴과 유사한 것으로 판단된다.13)
순환 거래 횟수(Cycles)는 XGBoost 분류 모델과 회귀 모델에서 각각 0.
0863, 0.0237으로 상대적으로 높은 수준의 중요도를 나타냈다. Victor et a
l.(2021)은 동일한 지갑 주소들 간에 반복적인 순환 거래가 발생하는 경우조세포탈 위험이 높다고 주장하였다. 본 연구에서 GAT 모델로 탐지한이상 거래 패턴 수치가 높은 지갑 주소들은 순환 거래 횟수가 비정상적으로 발생하는 경향이 있었으며, 이러한 경향은 조세포탈의 위험도가 높은지갑 주소의 특징을 나타내는 것으로 판단된다.14)
송신 트랜잭션 총 가스 허용량(totGasOut)은 분류 모델과 회귀 모델에서각각 0.0240, 0.0904의 중요도를 나타냈는데, Katherine et al.(2023)에 따르면 비정상적인 가스비 설정은 거래 출처나 소득을 은닉하려는 조세포탈가능성이 있다고 주장하였다. 본 연구에서 GAT 모델로 탐지한 이상 거래 패턴 수치가 높은 지갑 주소들은 송신 트랜잭션에서 가스 허용량이 비정상적으로 발생하는 경향이 있었으며, 이러한 경향은 높은 조세포탈 가능성을 시사하는 것으로 판단된다.15
1. Friedhelm Victor, Andrea Marie Weintraud, “Detecting and Quantifying
Wash Trading on Decentralized Cryptocurrency Exchanges“, WWW(2021)
2. Katherine Baer, Ruud de Mooij, Shafik Hebous, Michael Keen, “Crypto
Poses Significant Tax Problems—and They Could Get Worse“, IMF
(2023)
15 Wagman, Shlomit, “Cryptocurrencies and National Security The Case of
Money Laundering and Terrorism Financing“, Harvard National Security
Journal, Vol. 14, Issue 1 (2022), pp. 87-101
- 48 -
이 외에도 네트워크 구조상 위치와 실제 거래 행위 간 불일치를 보이는코사인 유사도 이상 패턴이나, uniqueEdgesOut, edgesOut의 이상 패턴과조세포탈 위험성의 연관성을 연구한 자료는 없었으나 이러한 속성들도 조세포탈 위험 징후를 나타내는 비정상적 거래 패턴과 연관성이 있을 것임을 직관적으로 이해할 수 있다.
본 연구의 분석 결과는 GAT 오토인코더 모델과 XGBoost 모델의 종합적인 분석을 통해 가상자산 조세포탈 위험도를 분석할 수 있음을 보여준다. 특히, 여러 이상 패턴이 복합적으로 나타나는 지갑 주소의 경우 재구성 오차가 높게 측정되며, 재구성 오차 측정값이 높은 지갑 주소를 조세포탈 위험도가 높은 지갑 주소로 판단할 수 있다.
다만 이러한 패턴들은 조세포탈 위험을 시사하는 정황 증거일 뿐이며,
실제 조세포탈 여부는 가상자산 실명 확인 과세자료 등을 활용하여 조사를 통해 확인해야 할 것으로 판단된다.
- 49 -
지갑 주소 레이블 확인된 내용
0xb6e36be24994bdf3f32b0f
daf38f3b4ed06ffa54
A_silkroad
I_identifier
중앙화 거래소 입금 전용
(Upbit)
0xbe83332aededa2cb031b2
0ac2dd8b57cf8d50500
A_silkroad
I_identifier
중앙화 거래소 입금 전용
(Coinone)
0x5952473955fe79b90d8b1
5d6ca7df96adf473711
A_silkroad
I_identifier
중앙화 거래소 입금 전용
(Coinone)
0x95cbeafa4b2d5fe18eb284
e1b767d68d450bf56e
A_silkroad
C_bottleneck
I_identifier
중앙화 거래소 입금 전용
(Coinone)
0xffef32ac831b0cf1ea4bbe8
513cb51eb55846a70
A_silkroad
C_bottleneck
D_receiver
I_identifier
중앙화 거래소 입금 전용
(Coinone)
0x239d8b6c1b7ae31905d01
2e6cfc040e631be55c1
A_silkroad
I_identifier
중앙화 거래소 입금 전용
(Upbit)
0xd25ff50183288b78d909d
16ed79730951e1fbe90
C_bottleneck
I_identifier
중앙화 거래소 입금 전용
(Coinone)
0x539f99b5de32d826ef17b
a0ff17837533ef714e6 I_identifier 중앙화 거래소 입금 전용
(Coinone)
제 2 절 그래프 기반 가상자산 이동 경로 분석
1. 중앙화 거래소 입금 전용 지갑 주소 사례 연구
본 연구에서는 가상자산의 흐름을 분석하기 위해 중앙화 거래소 입금 전용 지갑 주소의 거래 패턴인 I_identifier 레이블이 부여된 지갑 주소를 대상으로 사례 연구를 수행하였다.
사례 연구는 이더스캔을 통해 대상 지갑 주소에서 발생한 모든 송신 트랜잭션의 상대방이 중앙화 거래소 관리 지갑 주소인지 여부를 먼저 검토하였으며, 검토 대상 지갑 주소(총 19개)는 모두 실제 중앙화 거래소 입금전용 지갑 주소로 확인되었다.
- 50 -
0xdcfb1a832125434ae3deb
019ebaedf7912ac93af
C_bottleneck
I_identifier
중앙화 거래소 입금 전용
(Coinone)
0x75930135045990329184b
fc83b37a1bcbe979e24 I_identifier 중앙화 거래소 입금 전용
(Coinone)
0xab94ce7148ab59db28623
91458f1fe4a78850b41 I_identifier 중앙화 거래소 입금 전용
(Coinone)
0x7fac7d5785b4e34cf771a0
9fa79b8c51f250d9af I_identifier 중앙화 거래소 입금 전용
(Coinone)
0x63ed3dcdb9c71e112d1de
6b741f91bd636866a18 I_identifier 중앙화 거래소 입금 전용
(Coinone)
0x97d36dc7170fba08a07c3
6e8872d2746aa9c43fe I_identifier 중앙화 거래소 입금 전용
(Upbit)
0xf34c809e4a11cf2618a596
7e350e3d6843f3f141
A_silkroad
C_bottleneck
D_receiver
I_identifier
중앙화 거래소 입금 전용
(Upbit)
0xcfa46f83244d22357ccfe75
0c9f5cbe7101fc055
A_silkroad
C_bottleneck
I_identifier
중앙화 거래소 입금 전용
(Upbit)
0xedfdf676443273cb95138c
af2ffd4d5b13e72032
A_silkroad
I_identifier
중앙화 거래소 입금 전용
(Coinone)
0xe9698f321d925e6afc2235
350a8bd17fc90139bc
A_silkroad
D_receiver
I_identifier
중앙화 거래소 입금 전용
(Coinone)
0xe445fd900149019dc58ae
0c60e89c35b49c95776
A_silkroad
C_bottleneck
I_identifier
중앙화 거래소 입금 전용
(Upbit)
[표 13] 중앙화 거래소 입금 전용 지갑 주소 사례 연구
1. 중앙화 거래소 관리 목적 지갑 주소 사례 연구
중앙화 거래소 관리 목적 지갑 주소 거래 패턴 레이블인 X_exchange 지갑 주소 사례 연구에서는 이더스캔의 지갑 정보(태그)와 트랜잭션 내역을분석하여, X_exchange 레이블이 지정된 지갑 주소가 실제로 중앙화 거래소의 관리 목적으로 운영되고 있는지 여부를 확인하였다.
- 51 -
지갑 주소 레이블 확인된 내용
0x167a9333bf582556f35b
d4d16a7e80e191aa6476
A_silkroad
D_receiver
E_passthrough X_exchange
중앙화 거래소 관리 목적
(Coinone)
0x1938a448d105d26c40a
52a1bfe99b8ca7a745ad0
A_silkroad
C_bottleneck
D_receiver
X_exchange
중앙화 거래소 관리 목적
(Upbit)
사례 연구 결과, 총 2개의 X_exchange 지갑 주소 중 모두가 실제 중앙화 거래소의 입금 전용 지갑 주소로 확인되었다.
[표 14] 중앙화 거래소 관리 목적 지갑 주소 사례 연구
1. 중앙화 거래소 간 가상자산 이동 경로 분석
본 연구에서는 가상자산의 자금 흐름을 분석하기 위해 중앙화 거래소 입금 전용 지갑 주소로 레이블된 I_identifier 지갑 주소를 종점으로 하고,
중앙화 거래소 관리 지갑 주소로 레이블된 X_exchange 지갑 주소를 시점으로 하는 그래프 경로를 Cypher 쿼리로 추출하여 해당 경로에 있는 지갑 주소들의 특성을 분석하였다.
3.1 그래프 쿼리 및 시각화
중앙화 거래소 간 가상자산 이동 경로를 분석하기 위해 Neo4j Browser
에서 Cypher 쿼리를 사용하여 X_exchange 레이블이 부여된 특정 지갑주소에서 I_identifier 레이블이 부여된 특정 지갑 주소로 이어지는 경로를조회하고 그래프로 시각화하였다.
- 52 -
MATCH p=(a:X_exchange {address:
"0x1938A448d105D26c40A52a1Bfe99B8Ca7a745aD0"})-[r:NET_TO*3..3]->(b:I_i
dentifier {address: "0xEDFdF676443273CB95138cAF2Ffd4D5b13e72032"})
RETURN p
그래프 분석 결과, X_exchange 레이블이 부여된 특정 지갑 주소에서 4
개의 지갑 주소로 대규모 송신 트랜잭션이 발생했으며, 해당 지갑들로부터 직접 또는 스왑 거래를 주로 수행하는 지갑 주소를 통해 간접적으로I
_identifier 레이블이 부여된 지갑 주소로 토큰이 이동하였다. 본 연구에서사용한 그래프 쿼리 내용은 다음과 같다:
[그림 24] 중앙화 거래소 간 이동 경로 그래프 쿼리 예시
[그림 25] 중앙화 거래소 간 이동 경로 시각화 예시
3.2 중앙화 거래소 간 가상자산 이동 경로 지갑 주소 사례 연구
본 연구에서는 X_exchange 지갑 주소에서 I_identifier 지갑 주소로 연결되는 경로에 있는 지갑 주소 사례를 연구하였다. X_exchange 지갑 주소는 Upbit의 관리 목적 지갑 주소로 확인되었으며, I_identifier 지갑 주소
- 53 -
는 Coinone이 고객에게 제공하는 입금 전용 지갑 주소로 확인되었다.
또한, X_exchange 지갑 주소와 송신 트랜잭션으로 연결된 4개의 노드는중앙화 거래소(CEX)와 직접 연결된 지갑 주소로서, Upbit 거래소와 직접연결된 수신 트랜잭션이 확인되었다. X_exchange 지갑 주소와 직접 연결되지 않은 나머지 1개의 노드는 스왑 서비스를 주로 사용하는 지갑 주소로 확인되었다.
이때, X_exchange 지갑 주소와 직접 연결된 4개의 지갑 주소 및 I_ident
ifier 지갑 주소는 중앙화 거래소를 통해 지갑 주소의 소유자가 누구인지확인할 수 있다. 따라서, 본 사례에서 수행한 그래프 기반 가상자산 이동경로 분석 결과와 중앙화 거래소를 통해 확인된 가상자산 거래자의 신원정보를 결합하면, X_exchange와 직접 연결된 4개 지갑 주소의 소유자가직접 또는 스왑 서비스 지갑 주소를 거쳐 간접적으로 I_identifier 지갑 주소의 소유자에게 PICA 총 10,232,487개를 이전한 사실을 확인할 수 있다.
[그림 26] 중앙화 거래소 입금 전용 지갑 주소 트랜잭션
- 54 -
제 4 장 가상자산 조세포탈 대응 방안제 1 절 가상자산 실명 확인 과세자료
1. 소득세법 및 법인세법 상 가상자산 거래명세서
1.1 가상자산 거래 내역 등 제출 의무
소득세법 제164조의4는 “특정 금융거래정보의 보고 및 이용 등에 관한법률 제7조에 따라 신고가 수리된 가상자산사업자는 가상자산 거래 내역등 소득세 부과에 필요한 자료를 대통령령으로 정하는 바에 따라 거래가발생한 날이 속하는 분기의 종료일의 다음다음 달 말일까지 납세지 관할세무서장에게 제출하여야 한다.”고 규정하고 있으며, 소득세법 시행규칙제100조 제32호의4에서는 가상자산사업자가 제출하여야 하는 가상자산 거래명세서에 대해 규정하고 있다.16)
1.2 가상자산 거래명세서
소득세법 시행규칙 별지 제30호의3에서는 가상자산 거래명세서의 작성항목과 작성 방법을 구체적으로 설명하고 있다. 거래 유형은 가상자산의매도 및 매수, 가상자산 간 교환양도 및 교환취득, 가상자산의 대여, 이전,
인입, 기타 취득 유형으로 구분된다. 또한, 거래자와 거래 상대방 정보, 거래 가액과 수량 등 서식 작성 방법도 상세히 설명하고 있다.17)
2. 소득세법 제164조의4. 법인세법 120조의4에서도 동일한 의무사항을 규정하고있다.
3. OECD 가상자산 조세정보 보고체계(CARF) 도입과 관련 쟁점에 관한 小考,
정승영, 조세학술논집 제40집 제1호 (2024), 270면
- 55 -
[그림 27] 소득세법 상 가상자산 거래명세서
1.3 가상자산 실명 확인 과세자료
가상자산 거래명세서에는 거래 상대방의 가상자산 지갑 주소 정보가 포함되어 있어, 이를 활용하여 거래 상대방 정보를 블록체인 트랜잭션 데이터와 결합할 수 있다. 결합된 정보는 과세당국이 블록체인 트랜잭션에서발생하는 거래 소득 등을 과세하기 위한 자료로 활용될 수 있다.
1. 국조법 상 해외금융계좌 신고자료
국제조세조정법에 따른 해외금융계좌 신고자료에는 가상자산사업자에 개설된 계좌 정보가 포함되어 있어, 과세당국이 블록체인 트랜잭션 거래자를 식별하고 거래소득 및 이전소득을 과세하는 자료로 활용할 수 있다.
- 56 -
[그림 28] 국조법 상 해외금융계좌 신고서
- 57 -
2.1 해외금융계좌 신고 의무
국제조세조정법 제53조 제1항에 따르면, “해외금융계좌를 보유한 거주자및 내국법인 중 매월 말일 중 어느 하루의 해외금융계좌 잔액(해외금융계좌가 여러 개인 경우에는 각 해외금융계좌 잔액을 합산한 금액)이 대통령령으로 정한 금액(5억 원)을 초과하는 자는 다음 연도 6월 1일부터 30일까지 납세지 관할 세무서장에게 신고해야 한다.”고 규정하고 있다.
2.2 해외금융계좌의 범위
2023년 7월 18일 개정된 국제조세조정법 제52조 제2호에서는 “해외금융계좌란 해외금융회사와 금융거래(「금융실명거래 및 비밀보장에 관한 법률」 제2조 제3호에 의한 금융거래와 유사한 거래 포함) 및 가상자산 거래(「특정 금융거래정보의 보고 및 이용 등에 관한 법률」 제2조 제2호라목에 해당하는 가상자산 거래와 유사한 거래 포함)를 위하여 개설된 계좌”라고 정의하여 가상자산사업자에 개설된 계좌를 포함한다.18)
2.3 해외금융계좌 정보
해외금융계좌 정보는 국제조세조정법 제52조 제3호 각 목에서 다음과 같이 정의되어 있다.
가. 보유자의 성명ㆍ주소 등 신원에 관한 정보
나. 계좌번호, 해외금융회사등의 이름, 매월 말일의 보유계좌 잔액의 최고금액 등 보유계좌에 관한 정보
1. “국외 사업자가 개인 암호키 등을 보관 저장하는 프로그램만 제공할 뿐 통제권을가지지 않아 매도·매수·교환 등에 관여하지 않거나, 콜드 월렛 등 하드웨어 지갑서비스 국외 제조자 등이 판매하는 비수탁형·탈중앙화 지갑을 통해 가상자산을보유하는 경우는 국제조세조정에 관한 법률 제53조에 따른 해외금융계좌 신고대상에 해당하지 않습니다.”: 법령해석사례(서면-2023-법규국조-0507, 2023.10.30.)
- 58 -
다. 제53조제2항에 따른 해외금융계좌 관련자에 관한 정보
2.4 가상자산 실명 확인 과세자료
해외금융계좌 정보에는 가상자산사업자에 개설된 계좌 정보가 포함되어있어, 이를 활용하면 가상자산 보유자의 인적 사항 등을 블록체인 트랜잭션 데이터와 결합할 수 있다. 결합된 정보는 과세당국이 블록체인 트랜잭션에서 발생하는 거래소득 등에 대한 과세 자료로 활용될 수 있다.
1. 금융정보분석원 법집행기관 제공 자료
금융정보분석원이 법집행기관에 제공하는 정보에는 가상자산사업자가 금융정보분석원에 제출한 가상자산 거래자 정보가 포함되어 있어, 과세당국이 블록체인 트랜잭션의 거래자를 식별하고 거래소득 및 이전소득을 과세하는 데 활용될 수 있다.
3.1 법집행기관 정보 제공
금융정보분석원은 「특정금융정보법」 제10조에 따라, 조세 탈루 혐의확인을 위한 조사 또는 체납자 징수 업무 등 필요 시 국세청 등 법집행기관에 특정금융거래정보를 제공할 수 있다. 국세청 등은 필요 시 금융정보분석원에 해당 정보 제공을 요구할 수 있다.19)
3.2 특정금융거래정보
특정금융거래정보는 「특정금융정보법」 제10조 제1항에 규정된 바에 따라 다음과 같은 정보를 포함한다.
2. 특정 금융거래정보의 보고 및 이용 등에 관한 법률 제10조
- 59 -
가. 금융회사가 보고한 정보 중 특정 형사사건 수사와 관련된 정보
나. 외국 금융정보 분석기구로부터 제공받은 정보 중 특정 형사사건과 관련된 정보
다. 금융회사로부터 보고 또는 통보받은 정보를 정리하거나 분석한 정보특정금융정보법 시행령 제11조의2에 따라 국세청장에게 제공할 수 있는정보는 조세 탈루 혐의와 관련된 경우로, 매출액과 자산 규모 대비 현금거래가 과다한 경우나 역외탈세가 의심되는 경우 등의 정보가 포함된다.
3.3 트래블룰(Travel Rule)
특정금융정보법 제5조의3에 따라, 금융회사는 500만원 이상의 자금을 이체할 때 송금인 및 수취인 정보를 제공해야 하며, 가상자산사업자도 이에포함된다. 관련 법령은 가상자산사업자가 100만원 이상의 가상자산을 이전할 때 송금 및 수취인의 신원과 주소 등 식별 정보를 제공하도록 규정하고 있다.
3.4 의심 거래의 보고(Suspiiuouse Transaction Report)
특정금융정보법 제4조에 따르면, 금융회사는 의심스러운 금융거래가 발생한 경우 금융정보분석원에 즉시 보고해야 한다. 보고 대상에는 불법 재산이 개입된 의심 거래나 자금세탁 및 공중협박 자금조달 의심 거래 등이포함된다.
3.5 가상자산 실명 확인 과세자료
금융정보분석원이 국세청에 제공하는 특정금융거래정보는 가상자산사업자가 제출한 가상자산 거래 정보를 포함하므로, 이를 활용해 가상자산 거래자의 신원 정보를 블록체인 트랜잭션 데이터와 결합할 수 있다. 결합된정보는 과세당국이 블록체인 트랜잭션에서 발생하는 거래 소득 등을 과세
- 60 -
하기 위한 자료로 활용될 수 있다.
1. 의의 및 한계점
가상자산 거래자 신원 확인 제도는 과세당국이 의심스러운 가상자산 거래의 거래자의 정보를 선제적으로 확보하여 대응할 수 있도록 기반을 마련해주었다는 점에서 매우 중요한 의미를 갖는다.
하지만, 가상자산 거래자 신원 확인 제도를 통해 제출되는 실명 확인 과세자료로 거래자의 실명을 확인할 수 있는 거래와 지갑 주소는 중앙화 거래소와 직접 연결된 거래와 지갑 주소로 한정되기 때문에, 중앙화 거래소와 연결되지 않은 가상자산 거래의 거래자와 지갑 주소의 소유자는 확인할 수 없다는 한계점이 있다.
이러한 한계점을 극복하기 위해서는 가상자산 실명 확인 과세자료뿐만아니라 블록체인 트랜잭션 데이터를 함께 활용하여 중앙화 거래소와 직접연결되어 있지 않은 거래까지 분석하여야 하며, 블록체인 트랜잭션 데이터를 활용하여 중앙화 거래소와 직접 연결되어 있지 않은 거래를 분석하기 위해서는 그래프 데이터베이스와 AI를 활용한 조세포탈 대응방안이필요하다.
- 61 -
제 2 절 가상자산 조세포탈 대응 방안
1. 자체 개발 프로그램
본 연구에서는 앞서 제시한 그래프 데이터베이스 모델링 및 분석 과정을파이썬(3.9.13) 프로그램 3종(T1, T2, T3)으로 구현 하였으며, 이를 바탕으로 가상자산 조세포탈 대응 방안을 제시하고자 한다.
1.1 트랜잭션 데이터 수집 및 변환 프로그램(T1)
T1 프로그램은 토큰 주소(Contract address)와 API key를 입력하면 이더스캔에서 해당 토큰의 트랜잭션 데이터를 10,000건씩 분할해서 CSV 파일로 저장하고, 이를 변환하여 SQLite DB(.db) 파일로 저장하는 작업을수행하는 프로그램이다.
이더스캔 API는 블록 구간 지정 없이 특정 토큰에 대한 데이터를 요청하는 경우 최초 트랜잭션이 생성된 블록에서부터 이후 10,000번째 트랜잭션이 속한 블록까지만 데이터를 제공한다. 따라서, 전체 트랜잭션 데이터를 수집하기 위해서는 10,000개 이내의 트랜잭션이 포함될 수 있는 블록구간을 분할해서 정하고, 분할된 블록들의 구간을 정확히 지정해서 여러번 API 요청을 보내야 하는데 일반적인 조사요원20)이 이를 이해하고 실제로 작업을 수행하기 위해서는 많은 시간과 노력이 소모된다.
T1 프로그램은 수집 대상 트랜잭션을 10,000개 이내로 분할하기 위한 블록 구간을 자동으로 확인하고 분할된 블록 구간별로 이더스캔 API 요청을 보냄으로써, 일반적인 조사요원도 특정 토큰의 전체 트랜잭션 데이터를 한꺼번에 수집하여 SQLite DB 파일로 저장할 수 있도록 해준다.
2. 본 연구에서 수행한 블록체인 트랜잭션 데이터 수집 및 분석 과정을 직접 구현하고 실행할 수 있는 지식과 경험을 갖추지 않은 국세 행정 공무원
- 62 -
1.2 Neo4j 그래프 데이터베이스 모델링 및 구축 프로그램(T2)
T2 프로그램은 T1 프로그램으로 생성된 SQLite DB 파일에 저장된 트랜잭션 데이터를 Neo4j 그래프 데이터베이스로 모델링하여 구축하는 작업을 수행하는 프로그램이다.
본 연구에서 사용한 그래프 데이터베이스 모델링 기법을 사용하기 위해서는 트랜잭션 데이터를 그래프 개체로 표현하기 위한 방법과 각 노드에거래 패턴을 나타내는 속성을 추가하기 위한 방법, 그리고 특수 거래 패턴 레이블을 구현하기 위한 방법을 알아야 하는데 일반적인 조사요원은블록체인 트랜잭션 데이터를 수집하더라도 이를 그래프 데이터베이스로모델링하여 구현하기 어렵다.
T2 프로그램은 그래프 데이터베이스 모델링 및 구축 과정을 자동화함으로써 일반적인 조사요원도 본 연구에서 사용한 그래프 데이터베이스 모델링 기법을 그대로 적용하여 블록체인 트랜잭션 데이터를 Neo4j 그래프데이터베이스로 구현할 수 있도록 해준다.
1.3 AI 기반 그래프 데이터베이스 분석 프로그램(T3)
T3 프로그램은 T2 프로그램을 통해 구축된 Neo4j 그래프 데이터베이스에 AI 기반 이상 거래 패턴 분석 방법을 적용하고 분석한 결과를 엑셀파일(.xlsx)로 저장하는 작업을 수행하는 프로그램이다.
오토인코딩 기법을 사용한 GAT 모델을 그래프 데이터베이스로 구축한블록체인 트랜잭션 데이터에 적용하고 GAT 모델로 탐지한 이상 거래 패턴을 XGBoost 머신러닝 알고리즘으로 분석하기 위해서는 파이썬 코드작성 능력과 인공지능 학습 모델 사용 방법에 대한 이해가 필요하기 때문에 일반적인 조사요원은 블록체인 트랜잭션 데이터를 그래프 데이터베이
- 63 -
스로 구현한다고 하더라도 AI 기반 이상 거래 패턴 분석 방법을 적용하기 어렵다.
T3 프로그램은 T2 프로그램을 통해 구현된 그래프 데이터베이스를 대상으로 한 AI 기반 이상 거래 패턴 분석을 자동화함으로써, 일반적인 조사요원도 T3 프로그램을 사용해서 Neo4j 그래프 데이터베이스에 구현된블록체인 트랜잭션 데이터를 오토인코딩 기법을 사용한 그래프 신경망 모델(GAT)로 분석하여 지갑 주소별 이상 거래 패턴을 탐지할 수 있도록해준다.
조사요원은 T3 프로그램이 생성한 엑셀 파일 노드분석 시트에서 GAT
모델이 탐지한 지갑 주소별 이상 거래 패턴의 발생 정도(재구성 오차)를확인할 수 있다. 또한, 지갑 주소 노드에 추가된 속성 정보와 특수 거래패턴 레이블, 중심성 알고리즘 측정값의 평균 등을 확인할 수 있기 때문에 조사요원은 재구성 오차가 큰 지갑 주소의 특징을 종합적으로 분석할수 있다.
다음으로 조사요원은 재구성 오차의 측정이 주로 지갑 주소의 어떤 속성에 영향을 받았는지 분석한 결과를 GAT 이상 거래 패턴 요인 분석 시트에서 확인할 수 있다. GAT 이상 거래 패턴 요인 분석 시트에서는 GAT
모델 학습에 사용된 59가지 속성별 중요도를 측정하여 보여주기 때문에일반적인 조사요원도 재구성 오차가 큰 지갑 주소가 주로 어떤 속성에서이상 패턴을 보이는 지 쉽게 파악할 수 있다.
조사요원이 재구성 오차에 영향을 미친 주요 요인이 일반적으로 나타내는 정상적인 패턴과 비정상적 발생 패턴이 어떻게 나타나는지 확인할 수있다면 해당 지갑 주소의 조세포탈 위험성을 보다 효과적으로 평가할 수있다. 조사요원은 엑셀 파일의 XGBoost 속성별 모델 분석 시트에서 지갑주소의 59가지 속성이 나머지 58가지 속성 값과 어떤 상관관계를 가지는지 수식(Formula)에서 각 항목의 가중치를 통해 손쉽게 파악할 수 있고,
- 64 -
시트구분 상세구분 내용
노드 분석 속성 정보 지갑 주소 노드(addr) 별 속성 정보(35가지)
레이블 지갑 주소 노드별 특수 거래 패턴
레이블(10가지)
벡터 값
노드별로 속성 정보(35가지)와 그래프 구조를
반영하여 Node2Vec 알고리즘으로 학습한
64차원 그래프 임베딩 벡터 값
코사인
유사도
노드별 그래프 임베딩 벡터 값과 중심성
벡터와의 코사인 유사도
재구성 오차 GAT 모델로 계산한 재구성 오차 값
이상 거래
패턴 여부 정규화 재구성 오차 값이 z-score 2이상인 노드
XGBoost
속성별
모델 분석
설명력(R2) 속성별(59개) XGBoost 회귀 모델의 설명력
모델별
계산식 각 모델의 계산식
GAT
이상 거래
패턴
요인 분석
분류 모델
측정
GAT anomaly(이상 거래 패턴 노드 여부)를
레이블로 학습한 분류 모델의 AUC, F-score,
Precision, Recall과 속성별 중요도(Importance)와
SHAP(SHapley Additive exPlanations) 메커니즘
회귀 모델
측정
GAT error(재구성 오차)를 레이블로 학습한 회귀
모델의 R
2와 RMSE, 속성별 중요도(Importance)
각 속성의 설명력(R2)을 통해 그러한 상관관계의 강도(level)가 어느 정도인지 알 수 있다.
조사요원은 이상 거래 패턴 수치가 높은 지갑 주소가 집중되어 있는 커뮤니티의 특성을 확인하기 위해 커뮤니티 분석 시트의 정보를 활용할 수있다. 해당 시트에서는 각 커뮤니티의 각종 통계 값과 커뮤니티의 전반적인 이상 패턴을 파악할 수 있는 각 커뮤니티 조합간 코사인 유사도의 평균값을 확인할 수 있다.
T3 프로그램에서 생성하는 엑셀 파일에 포함되어 있는 정보는 다음과같다.
- 65 -
메커니즘
커뮤니티
분석
통계 정보
커뮤니티별 중심 노드 지갑 주소, 노드 개수, 밀도, 트랜잭션 횟수, 트랜잭션 총 수량, 트랜잭션 평균 수량, 트랜잭션 수량 표준편차, 코사인
유사도
해당 커뮤니티와 나머지 커뮤니티 간 평균
코사인 유사도
벡터 값 커뮤니티별 중심성 벡터(64차원)
[표 15] T3 프로그램 엑셀 파일 분석 상세내역
[그림 29] T3 XGBoost 속성별 모델 분석 결과 화면
- 66 -
1. 프로그램 기반 가상자산 조세포탈 대응 방안
본 연구에서는 앞서 제시한 자체 개발 프로그램을 기반으로 한 가상자산조세포탈 대응 방안을 AI 기반 조세포탈 위험 거래 모니터링과 그래프기반 가상자산 이동 경로 분석 2가지로 구분하여 제시하고자 한다.
2.1 AI 기반 조세포탈 위험 거래 모니터링
국세청은 2024년 7월, 가상자산 발행 수입과 매각 차익 신고를 누락한역외 탈세 혐의자를 적발하였다고 발표하였다.21) 적발 사례에서와 같은가상자산 발행 회사들은 직접 메인넷(Main net)을 개발하기 보다는 기존에 만들어진 블록체인의 네트워크를 사용한 토큰을 발행하는 경우가 많고, 그 중에서도 ERC-20은 발행과 유통이 매우 쉬워 가상자산 발행에 많이 사용되고 있으므로 ERC-20 기반 토큰을 대상으로 한 조세포탈 위험거래 모니터링이 필요한 상황이다.
[그림 30] 가상자산 발행 관련 조세포탈 사례
2. 국세청, 국적세탁, 가상자산은닉, 해외 원정 진료 소득 탈루. 국세청 추적 피하려는 역외탈세 백태, 2024.7.2
- 67 -
본 연구에서 제시한 자체 개발 프로그램은 일반적인 조사요원도 이더리움 블록체인 ERC-20 기반 토큰을 AI로 분석하여 조세포탈 위험도가 높은 지갑 주소를 선별할 수 있도록 도와준다.
조사요원은 T3 프로그램이 생성한 엑셀 파일에서 GAT 모델이 탐지한이상 거래 패턴 수치(재구성 오차)에 영향을 미친 주요 속성이 무엇인지확인할 수 있다. 다음으로, XGBoost 속성별 모델 분석 결과를 통해 주요속성들과 나머지 속성들과의 상관관계를 확인해서 재구성 오차가 큰 지갑주소는 어떤 거래 패턴을 나타내는지 파악할 수 있으며, 이를 바탕으로이더리움 블록체인 ERC-20 토큰의 지갑 주소별 조세포탈 위험도를 평가할 수 있다.
[그림 31] AI 기반 이상 거래 패턴 분석 개념도
- 68 -
이처럼 자체 개발 프로그램을 사용하여 정상적인 거래 패턴과 이상 거래패턴을 구분할 수 있기 때문에, 주기적으로 조세포탈 위험성이 높은 토큰과 지갑 주소를 모니터링하여 ERC-20 기반 토큰을 악용한 가상자산 조세포탈에 선제적으로 대응할 수 있다.
2.2 그래프 기반 가상자산 이동 경로 분석
스테이블코인(Stablecoin)은 가상자산 시장의 주요 지급결제 수단으로 사용되고 있으며, 가상자산 거래에 스테이블 코인을 사용한 비중은 2022년8월말 기준 87%에 달하고 있다. 스테이블 코인 중에서는 테더(Tether, U
SDT)의 시가총액 비중은 2022년 기준 45%로 가장 크며22), 테더는 주로이더리움과 트론 블록체인의 토큰으로 발행되고 있다.
[그림 32] 이더리움 및 트론 테더 발행 비중 (출처: 크립토퀀트)
1. 장보성, “스테이블 코인의 리스크와 정책 과제”, 자본시장연구원 (2022).
p.3-4
- 69 -
이더리움 블록체인의 테더는 ERC-20 기반 토큰(USDT)이기 때문에, ER
C-20 기반 토큰으로 사용되는 테더의 자금 추적은 가상자산 조세포탈에서 중요한 부분을 차지하고 있다고 볼 수 있다.
2024.11.23. 기준 이더리움 블록체인 USDT 토큰의 전체 트랜잭션 개수는 약 2억6천만개에 달하기 때문에 본 연구에서는 USDT 대신 규모가 작은 PICA 트랜잭션 데이터를 사용하여 일반적으로 ERC-20 기반 토큰에적용할 수 있는 가상자산 이동 경로 분석 방법론을 제시하고자 한다.
[그림 33] 이더리움 ERC-20 테더 발행량
본 연구에서는 자체 개발한 프로그램을 사용하여 그래프 데이터베이스로구현한 이더리움 블록체인 ERC-20 기반 토큰의 트랜잭션 데이터에서 가상자산의 이동 경로를 분석하고, 이를 활용한 조세포탈 대응 방안을 제시하고자 한다.
첫째, 오토인코딩 기법을 사용한 GAT 모델이 탐지한 재구성 오차가 큰지갑 주소에서 중앙화 거래소 입금 전용 지갑 주소로 이어지는 가상자산이동 경로를 분석하여 주기적으로 조세포탈 위험도가 높은 지갑 주소를모니터링하는 방안이다.
- 70 -
조사요원은 T1, T2 프로그램을 사용하여 ERC-20 트랜잭션 데이터를 그래프 데이터베이스로 모델링 하는 과정에서 중앙화 거래소 입금 전용 지갑 주소의 거래 패턴을 가진 지갑 주소에 특수 거래 패턴 레이블을 부여하여 이를 구분 할 수 있고, T3 프로그램을 사용하여 AI 모델로 사용해서 이상 거래 패턴 수치가 큰 지갑 주소를 탐지할 수 있다.
그 다음, 중앙화 거래소 입금 전용 지갑 주소의 거래 패턴 레이블과 지갑 주소별 이상 거래 패턴 수치 정보를 활용해서 Cypher 쿼리로 이상 거래 패턴 수치가 높은 지갑 주소에서 중앙화 거래소 입금 전용 지갑 주소거래 패턴 레이블로 연결되는 경로를 조회하면 해당 경로를 그래프로 시각화하여 분석할 수 있다.
이를 통해 조세포탈 위험성이 높은 거래와 연계된 지갑 주소의 소유자를중앙화 거래소를 통해 확인할 수 있기 때문에 거래자의 체납 여부나 소득신고 적정 여부 등 국세 행정 정보를 연계하여 분석함으로써 체납재산 은닉 및 소득신고 누락 등 조세포탈 발생 여부를 확인할 수 있다.
둘째, 그래프 쿼리를 사용해 중앙화 거래소 입금 전용 지갑 주소별로 수신된 가상자산의 수량을 집계하고 이를 가상자산 실명 확인 과세자료와비교하여 검증하는 방안이다. 이를 통해, 중앙화 거래소의 고객이 가상자산 사업자에게 의도적으로 허위의 정보를 제공하거나 오류로 거래 관련정보를 잘못 입력한 경우를 확인하여, 가상자산 거래 소득의 누락 또는과소신고 여부를 검증할 수 있다.
앞서 언급한 바와 같이 조사요원은 T1, T2 프로그램을 사용하여 이더리움 블록체인 ERC-20 토큰의 트랜잭션 데이터를 그래프 데이터베이스로모델링하는 과정에서 중앙화 거래소 입금 전용 지갑 주소의 거래 패턴을가진 지갑 주소에 특수 거래 패턴 레이블을 부여하여 이를 구분할 수 있다.
- 71 -
이를 통해, 중앙화 거래소 입금 전용 지갑 주소의 거래 패턴 레이블을활용한 Cypher 쿼리로 중앙화 거래소 입금 전용 지갑 주소로 수신되는가상자산의 수량을 지갑 주소별로 집계하고, 이를 가상자산 거래명세서집계 자료와 비교하여 조세포탈 발생 여부를 검토할 수 있다.
셋째, 특수관계자 간 가상자산을 이전한 경우 등과 관련된 중앙화 거래소 간 이동 경로를 그래프 쿼리를 통해 식별하고, 식별된 이동 경로와 관련된 지갑 주소들의 조세포탈 발생 여부를 검토하는 방안이다.
조사요원은 T1, T2 프로그램을 사용하여 ERC-20 트랜잭션 데이터를 그래프 데이터베이스로 모델링 과정에서 중앙화 거래소 입금 전용 지갑 주소와 중앙화 거래소 관리 목적 지갑 주소의 거래 패턴을 가진 지갑 주소에 특수 거래 패턴 레이블(I_identifier, X_exchange)을 부여함으로써 이를구분할 수 있다.
이를 통해, 중앙화 거래소 관리 목적 지갑 주소와 중앙화 거래소 입금전용 지갑 주소의 거래 패턴 레이블을 활용한 Cypher 쿼리로 중앙화 거래소 관리 목적 지갑 주소로부터 중앙화 거래소 입금 전용 지갑 주소로연결되는 경로를 조회하여 중앙화 거래소간 가상자산의 이동 경로를 시각화하여 분석할 수 있으며, 변칙적인 거래를 통해 가상자산을 특수관계자에게 이전한 경우나 가상자산으로 상거래 대금을 수취하고 신고를 누락한경우 등 조세포탈 거래를 확인할 수 있다.
- 72 -
제 5 장 결 론
본 연구는 가상자산 조세포탈 대응 체계의 한계점을 극복하기 위해 블록체인 트랜잭션 데이터를 효과적으로 활용하기 위한 방법을 연구하였다.
이를 위해 블록체인 트랜잭션 데이터를 AI로 분석하여 이상 거래 패턴을 탐지하고, 이를 바탕으로 지갑 주소별 조세포탈 위험도를 판단하기 위한 방법을 연구하였으며, 중앙화 거래소 관련 지갑 주소의 특성과 중앙화거래소 간 가상자산의 이동 경로를 그래프로 분석하기 위한 방법을 연구하였다.
본 연구의 의의는 비지도 학습 모델로 재구성 오차를 측정하고, 이를 머신러닝으로 학습하여 재구성 오차가 측정된 근거를 분석할 수 있는 방법을 제시함으로써, 학습 데이터가 충분하지 않더라도 AI 모델로 지갑 주소별 조세포탈 위험도를 평가할 수 있는 기반을 제시했다는 점이다.
또한, 가상자산 조세포탈 대응을 위해 반드시 필요한 정보인 중앙화 거래소 관련 지갑 주소를 식별할 수 있는 구체적인 방법을 제시하였다는 점과 이를 그래프로 시각화하여 가상자산의 이동 경로를 효과적으로 분석할수 있는 방법을 제시하였다는 점에서 본 연구의 의의가 있다.
향후 가상자산 신원 확인 제도가 정착되어 가상자산 조세포탈 적발 사례관련 데이터가 누적된다면 본 연구 결과를 바탕으로 지도 학습 방법 기반그래프 신경망 모델을 적용할 수 있고, 이를 통해 보다 효과적인 가상자산 조세포탈 대응 체계를 구축할 수 있을 것으로 기대된다.
본 연구가 가상자산 거래를 통한 조세포탈을 방지하고 건전한 가상자산생태계가 조성되는데 조금이나마 기여할 수 있기를 기대한다.
- 73 -
참 고 문 헌
1. Chanalysis, “2024 가상자산 범죄 보고서”, 체이널리시스 (2024).
2. Petar Veliˇckovi´c, Guillem Cucurull, Arantxa Casanova, Adriana Ro
mero, Pietro Li`o, Yoshua Bengio, “GRAPH ATTENTION NETWO
RKS”, ICLR (2018)
3. Ziquan You, Xiaoying Gan, Luoyi Fu, Zhen Wang, "GATAE: Graph
Attention-based Anomaly Detection on Attributed Networks", ICCC
(2020)
4. Lei Yu, Fengjun Zhang, Tianqi, Jiajia Ma, Li Yang, Yuanzhe Yang,
Wei Jia, “Who Are the Money Launderers? Money Laundering Det
ection on Blockchain via Mutual Learning-Based Graph Neural Net
work”, IJCNN (2023)
5. Tianqi Chen, “XGBoost: A Scalable Tree Boosting System”, KDD
(2016)
6. 정승영, “OECD 가상자산 조세정보 보고체계(CARF) 도입과 관련 쟁점에 관한 小考”, 조세학술논집 제40집 제1호 (2024)
7. 강준하. “가상화폐 스캠 탐지를 위한 딥러닝 기반 블록체인 전송내역그래프 분석 방법들” 정보과학회지 (2024. 3).
8. 정승영, “가상자산의 이용과 조세 포탈에서의 적극적 은닉에 대한 대응 방안 고찰”, 租稅法硏究 [28-2] (2022).
9. 김석환·김범준, “가상자산을 활용한 탈세 대응 방안“, 한국세법학회(2023)
10. 김기성·장기식, “그래프 머신러닝”, 에이콘 (2023. 1).
11. 데니즈 고즈넬, 마티아스 브뢰헬러, “실무자를 위한 그래프 데이터 활용법”, 한빛미디어 (2022. 5).
- 74 -
1. 마크 니덤, 에이미 호들러, “그래프 알고리즘” 에이콘출판사 (2021)
2. Friedhelm Victor, Andrea Marie Weintraud, “Detecting and Quantif
ying Wash Trading on Decentralized Cryptocurrency Exchanges“,
WWW (2021)
3. Katherine Baer, Ruud de Mooij, Shafik Hebous, Michael Keen, “Cry
pto Poses Significant Tax Problems and They Could Get Worse“ ,
IMF (2023)
4. Wagman, Shlomit, “Cryptocurrencies and National Security The Ca
se of Money Laundering and Terrorism Financing“, Harvard Natio
nal Security Journal, Vol. 14, Issue 1 (2022), pp. 87-101
5. 국제조사과, “국적 세탁, 가상자산 은닉, 해외 원정 진료 소득 탈루 국세청 추적 피하려는 역외탈세 백태”, 국세청 (2024. 7).
6. 장보성, “스테이블 코인의 리스크와 정책 과제”, 자본시장연구원(2022).
7. 블루밍비트, “트론(TRX), 급성장...USDT 핵심 인프라로 부상”, https:/
/bloomingbit.io/feed/news/71937, 2024.7.21.
- 75 -
Abstract
Analysis of Tax Evasion
through Virtual Asset
based on Graph Database and AI
HeuiWon Jang
Master of Science in Digital Forensics
Department of Mathematical Information Science
The Graduate School of
Convergence Science and Technology
Seoul National University
Virtual assets are increasingly being misused for criminal activities
due to their anonymity and decentralized nature. In response, Korea
has been implementing and enforcing identity verification measures for
virtual asset transactions since 2021.
While the implementation of identity verification measures for
- 76 -
virtual asset transactions has enabled the identification of traders in
transactions directly linked to centralized exchanges (CEX),
transactions not directly connected to CEX still present anonymity
challenges.
To address transactions not directly linked to centralized
exchanges, it is necessary to utilize blockchain transaction data.
However, research on leveraging blockchain transaction data to counter
virtual asset tax evasion remains insufficient.
This study models blockchain transaction data in a graph database
and does not directly predict tax evasion. Instead, it uses AI to detect
anomalous transaction patterns by wallet address, and employs
machine learning to quantify and analyze the underlying causes of
these patterns. The research explores methods to assess tax evasion
risk through anomalous pattern analysis and visualizes asset flows
connected to centralized exchanges using graph technology. These
methods are implemented as a Python program to propose systematic
countermeasures against virtual asset tax evasion.
keywords : Graph Database, AI, Graph Neural Network, Virtual
Asset, Tax Evasion
Student N umbe r : 2023-29845