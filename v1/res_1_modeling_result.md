## GNN 검증 결과 분석

`gnn_validation_results.csv`에 기록된 실험 결과를 요약·해석합니다.

| 모델 | train MSE | val MSE | epochs |
|---|---:|---:|---:|
| GCN_AE | 3006879.25 | 1778398.5 | 30 |
| SAGE_AE | 61221.4296875 | 59957.30078125 | 30 |
| GAT_AE | 3009724.25 | 3018049.0 | 30 |
| PaperGAT_AE | 4175646.25 | 4197445.5 | 50 |

### 주요 발견
- **최우수 모델**: `SAGE_AE`가 가장 낮은 train/val MSE를 보이며(약 6.0e4), 다른 모델들에 비해 성능이 압도적으로 우수합니다.
- **불안정/저성능 모델**: `GCN_AE`, `GAT_AE`, `PaperGAT_AE`는 MSE가 매우 크고(수백만 단위) `train`과 `val` 모두 높은 값을 가집니다. 이는 재구성 대상(원본 피처)의 스케일이 크거나 모델/학습 설정이 적절하지 않을 가능성을 시사합니다.
- **일반화 경향**: `SAGE_AE`의 train/val 간 격차가 작아(약 1~2%) 일반화가 잘 된 것으로 보입니다. 반면 다른 모델들은 전반적으로 높은 오차 수준을 유지합니다.

### 가능한 원인
- **특성 스케일 문제**: 입력 피처(예: `uniqedgesIn`, `centralitypagerank`, `cycles`, `dayvaloutlier`)와 재구성 목표의 크기 차이가 커서 MSE가 크게 나타났을 가능성.
- **레이블(타깃) 스케일**: 오토인코더가 원본 특성 자체를 재구성하는 설정이므로, 값의 절대 크기가 크면 MSE가 큰 값으로 측정됩니다.
- **모델-데이터 적합성**: GraphSAGE의 집계 방식이 본 데이터셋(이더리움 트랜잭션 기반 네트워크)의 특성(이웃 집계 필요성)에 더 적절했을 수 있음.
- **하이퍼파라미터/학습 안정성**: GAT 계열은 헤드 수, hidden dim, 드롭아웃 등 설정에 민감하며, 현재 설정이 최적이 아닐 수 있음.

### 권장 개선안 (우선순위)
- **피처 표준화/정규화**: 모든 입력 피처를 `StandardScaler` 또는 `MinMaxScaler`로 정규화하고, 특히 값의 스케일이 큰 피처는 로그 변환(log1p) 적용 후 재실험.
- **손실함수/평가지표 다양화**: MSE 외에 MAE도 함께 측정하면 스케일 민감도를 보완할 수 있음.
- **하이퍼파라미터 탐색**: GAT의 heads, hidden dim, learning rate, weight_decay, 드롭아웃을 그리드/베이지안 탐색으로 최적화.
- **정규화 기법 추가**: 배치 정규화 / 레이어 정규화 또는 더 강한 weight decay 사용.
- **조기종료(early stopping)**: 검증 손실 기반으로 조기종료를 적용하여 과적합을 방지.
- **입력-타깃 재정의**: 재구성 목표를 원본 피처 전체 대신 정규화된 임베딩(또는 일부 핵심 피처)으로 바꿔 실험.

### 다음 실험 제안
- **재구성 오차 기반 이상치 탐지**: 각 노드의 검증 재구성 오차를 z-score로 표준화해 이상치(예: z > 2 또는 3)를 탐지하고, 가능한 레이블(거래소/의심 지갑 등)과 비교.
- **임베딩 시각화**: 학습된 잠재공간(z)을 t-SNE/UMAP으로 시각화해 클러스터와 이상 노드 분포를 관찰.
- **노드/엣지 특성 추가 실험**: `netCount`, `earliestTimestamp` 요약치(예: frequency, recency) 등을 노드 입력으로 포함해 성능 변화 확인.
- **평가 지표 확장**: AUC/Precision@k 등 이상치 탐지 관점의 지표 추가.

### 결론
- 현재 실험에서 **GraphSAGE 기반 오토인코더가 가장 좋은 재구성 성능**을 보였습니다. 하지만 전체적으로 원본 특성의 스케일 영향이 커 보이므로, 먼저 피처 정규화와 손실함수/하이퍼파라미터 튜닝을 적용한 뒤 재평가하는 것을 권장합니다.


*생성: `result.md` — `gnn_validation_results.csv`의 요약 분석 보고서* 